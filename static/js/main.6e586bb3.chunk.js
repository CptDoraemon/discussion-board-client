(this["webpackJsonpdiscussion-board-client"]=this["webpackJsonpdiscussion-board-client"]||[]).push([[0],{132:function(e,t,a){e.exports=a(169)},137:function(e,t,a){},169:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),i=a(14),o=a.n(i),s=(a(137),a(11)),l=a(47),m={loginStatus:{isLogin:!1,username:"",token:{access:"",refresh:""}},snackbar:{open:!1,message:""}};function u(e){return{type:n.UPDATE_LOGIN_STATUS,newStatus:e}}!function(e){e.UPDATE_LOGIN_STATUS="UPDATE_LOGIN_STATUS",e.LOGOUT="LOGOUT",e.REFRESH_TOKEN="REFRESH_TOKEN"}(n||(n={}));var d,p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.loginStatus,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.UPDATE_LOGIN_STATUS:case n.LOGOUT:return t.newStatus;case n.REFRESH_TOKEN:var a=Object.assign({},e);return a.token.access=t.newAccessToken,a;default:return e}};function f(e){return{type:d.OPEN,message:e}}!function(e){e.CLOSE="CLOSE",e.OPEN="OPEN"}(d||(d={}));var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.snackbar,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.OPEN:return{open:!0,message:t.message};case d.CLOSE:return m.snackbar;default:return e}},b=Object(l.c)({loginStatus:p,snackbar:g}),h=a(109),v=Object(h.createLogger)();var E,x=a(214),j=a(208),O=a(8),y=a(121),k=a(216),w=Object(y.a)({palette:{primary:{main:"#41b3a3",contrastText:"#fff"},secondary:{main:"#e8a87c",contrastText:"#fff"},text:{primary:"#4a5568"},background:{default:"rgb(241, 242, 245)"}},typography:{fontFamily:"system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",fontSize:14,fontWeightLight:300,fontWeightRegular:400,fontWeightMedium:500}});(w=Object(k.a)(w)).typography.h1=(E={fontFamily:["Open-sans","sans-serif"].join(","),fontWeight:800,fontSize:"1.25rem"},Object(O.a)(E,w.breakpoints.up("md"),{fontSize:"1.5rem"}),Object(O.a)(E,"fontStyle","normal"),Object(O.a)(E,"color","inherit"),E);var S=w,N=a(16),C=a(45),I=a(197),L=a(3),T=a(171),D=function(e){var t=Object(r.useState)(0),a=Object(L.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)((function(){e.current&&c(e.current.getBoundingClientRect().height)}),[e]),n},_=Object(I.a)((function(e){return{root:{width:"100%",margin:e.spacing(2,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},image:Object(O.a)({width:"40%",height:"100%","& img":{width:"100%",height:"100%",objectFit:"cover"}},e.breakpoints.down("sm"),{display:"none"}),content:Object(O.a)({width:"60%",padding:e.spacing(10,5)},e.breakpoints.down("sm"),{width:"100%"}),textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),P=function(e){var t=e.children,a=e.imageUrl,n=_(),i=Object(r.useRef)(null),o=D(i);return c.a.createElement(T.a,{elevation:0,className:n.root,ref:i},c.a.createElement("div",{className:n.image},c.a.createElement("img",{src:"/discussion-board-client"+a,alt:"login background",style:{height:"".concat(o,"px")},title:"login background"})),c.a.createElement("div",{className:n.content},t))},A=a(203),W=a(200),U=a(217),F=a(215),R=a(207),H=a(199),M=Object(I.a)((function(e){return{button:{width:"100%",backgroundColor:e.palette.primary.main,color:"#fff",fontWeight:700,textTransform:"none",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px","&:hover":{backgroundColor:e.palette.secondary.main},"&:disabled":{backgroundColor:e.palette.secondary.main,opacity:.7}}}})),z=function(e){var t=e.text,a=e.disabled,n=e.form,r=M();return c.a.createElement(H.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,type:"submit",form:n,disabled:a},t)},B=function(e,t){var a=Object(r.useState)(e),n=Object(L.a)(a,2),c=n[0],i=n[1],o=Object(r.useState)(!1),s=Object(L.a)(o,2),l=s[0],m=s[1],u=Object(r.useState)(""),d=Object(L.a)(u,2),p=d[0],f=d[1];return[c,function(e){l&&m(!1),i(e.target.value)},l,p,function(e){var a=e?t(c,e):t(c);return m(!a.isValid),f(a.message),a.isValid}]},J=function(e){var t=!0,a="";return e.length>=30?(t=!0,a="Username length must be less than 30 characters"):0===e.length&&(t=!0,a="Username cannot be empty"),{isValid:t,message:a}},G=function(e){var t=!0,a="";return-1===e.indexOf("@")||-1===e.indexOf(".")?(t=!1,a="Invalid Email format"):0===e.length?(t=!1,a="Email cannot be empty"):e.length>=60&&(t=!1,a="Email too long"),{isValid:t,message:a}},V=function(e){var t=!0,a="";return 0===e.length&&(t=!1,a="Email cannot be empty"),{isValid:t,message:a}},X=function(e,t){var a=!0,n="";return e!==t&&(n="Not same as the password",a=!1),{isValid:a,message:n}},K=function(e){var t=!0,a="";return 0===e.length&&(a="Title cannot be empty",t=!1),{isValid:t,message:a}},Y=function(e){var t=!0,a="";return 0===e.length?(a="Comment cannot be empty",t=!1):e.length<5&&(a="Comment needs to be at least 5 characters",t=!1),{isValid:t,message:a}},$=function(e){for(var t=e.map((function(e){return e()})),a=0;a<t.length;a++)if(!t[a])return!1;return!0},q="https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/",Q=q+"post/",Z={login:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/login/",register:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/register/",verifySession:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/verify_session/",refresh:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/refresh/",updateAvatar:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/update_avatar/",getPostList:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/post/all/",getPostDetail:function(e){return"".concat(Q).concat(e,"/")},createPost:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/post/create/",createComment:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/comment/create/",like:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/user_actions/like/"},ee=function(){var e=Object(r.useState)(!1),t=Object(L.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(!1),i=Object(L.a)(c,2),o=i[0],l=i[1],m=Object(r.useState)(""),d=Object(L.a)(m,2),p=d[0],g=d[1],b=Object(s.c)(),h=Object(C.g)(),v=Object(C.h)();return[a,o,p,function(e,t){a||(l(!1),g(""),n(!0),fetch(Z.login,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(n(!1),"success"===e.status){var t=e.data.username;b(u({isLogin:!0,username:t,token:{access:e.data.access,refresh:e.data.refresh}}));var a=(v.state||{from:{pathname:"/"}}).from;h.replace(a),b(f("Welcome back ".concat(t)))}else l(!0),"error"===e.status?g(e.message):g("Server unavailable, please try again later.")})).catch((function(e){n(!1),l(!0),g("Server unavailable, please try again later.")})))}]},te=a(202),ae=Object(I.a)((function(e){return{errorMessage:{fontWeight:700,color:e.palette.error.main}}})),ne=function(e){var t=e.loading,a=e.errorMessage,n=e.error,r=ae();return c.a.createElement(W.a,{variant:"body1",component:"div"},c.a.createElement(U.a,{className:r.errorMessage,height:40},t?c.a.createElement(te.a,{color:"primary"}):n&&a?a:" "))},re=Object(I.a)((function(e){return{textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),ce=function(){var e=re(),t=B("",G),a=Object(L.a)(t,5),n=a[0],r=a[1],i=a[2],o=a[3],s=a[4],l=B("",V),m=Object(L.a)(l,5),u=m[0],d=m[1],p=m[2],f=m[3],g=m[4],b=ee(),h=Object(L.a)(b,4),v=h[0],E=h[1],x=h[2],j=h[3];return c.a.createElement(P,{imageUrl:"/images/login_bg.jpg"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),$([s,g])&&j(n,u)},id:"login-form"},c.a.createElement(A.a,{container:!0,spacing:2},c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(W.a,{variant:"h1",component:"h1",color:"textPrimary"},c.a.createElement(U.a,{textAlign:"center"},"Log In"))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:i,label:"Email",name:"email",value:n,onChange:r,variant:"outlined",helperText:i?o:" ",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:p,type:"password",label:"Password",name:"password",value:u,onChange:d,variant:"outlined",helperText:p?f:" ",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(z,{text:"Log me in!",form:"login-form",disabled:v}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(ne,{loading:v,error:E,errorMessage:x}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(R.a,null)),c.a.createElement(A.a,{item:!0,xs:12,className:e.link},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(N.b,{to:"/register"},"Need an account?"))))))},ie=function(){var e=Object(r.useState)(!1),t=Object(L.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(!1),i=Object(L.a)(c,2),o=i[0],l=i[1],m=Object(r.useState)(""),d=Object(L.a)(m,2),p=d[0],g=d[1],b=Object(s.c)(),h=Object(C.g)(),v=Object(C.h)();return[a,o,p,function(e,t,r,c){a||(l(!1),g(""),n(!0),fetch(Z.register,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r,confirm_password:c})}).then((function(e){return e.json()})).then((function(t){if(n(!1),"success"===t.status){b(u({isLogin:!0,username:t.data.username,token:{access:t.data.access,refresh:t.data.refresh}}));var a=(v.state||{from:{pathname:"/"}}).from;h.replace(a),b(f("Welcome ".concat(e,"!")))}else l(!0),"error"===t.status?g(t.message):g("Server unavailable, please try again later.")})).catch((function(e){n(!1),l(!0),g("Server unavailable, please try again later.")})))}]},oe=Object(I.a)((function(e){return{textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),se=function(){var e=oe(),t=B("",J),a=Object(L.a)(t,5),n=a[0],r=a[1],i=a[2],o=a[3],s=a[4],l=B("",G),m=Object(L.a)(l,5),u=m[0],d=m[1],p=m[2],f=m[3],g=m[4],b=B("",V),h=Object(L.a)(b,5),v=h[0],E=h[1],x=h[2],j=h[3],O=h[4],y=B("",X),k=Object(L.a)(y,5),w=k[0],S=k[1],C=k[2],I=k[3],T=k[4],D=ie(),_=Object(L.a)(D,4),H=_[0],M=_[1],K=_[2],Y=_[3];return c.a.createElement(P,{imageUrl:"/images/register_bg.jpg"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=$([s,g,O]),a=T(v);t&&a&&Y(n,u,v,w)},id:"register-form"},c.a.createElement(A.a,{container:!0,spacing:2},c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(W.a,{variant:"h1",component:"h1",color:"textPrimary"},c.a.createElement(U.a,{textAlign:"center"},"Join Us"))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:i,label:"Username",name:"username",value:n,onChange:r,helperText:i?o:" ",variant:"outlined",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:p,label:"Email",name:"email",value:u,onChange:d,helperText:p?f:" ",variant:"outlined",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12,md:6},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:x,label:"Password",name:"password",type:"password",value:v,onChange:E,helperText:x?j:" ",variant:"outlined",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12,md:6},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(F.a,{error:C,label:"Confirm Password",name:"confirm-password",type:"password",value:w,onChange:S,helperText:C?I:" ",variant:"outlined",className:e.textField}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(z,{text:"I'm in!",form:"register-form",disabled:!1}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(ne,{loading:H,error:M,errorMessage:K}))),c.a.createElement(A.a,{item:!0,xs:12},c.a.createElement(R.a,null)),c.a.createElement(A.a,{item:!0,xs:12,className:e.link},c.a.createElement(A.a,{container:!0,justify:"center"},c.a.createElement(N.b,{to:"/login"},"Already have an account?"))))))},le=Object(I.a)((function(e){return{button:{backgroundColor:"rgba(255,255,255,0.3)",color:"#fff",fontWeight:700,textTransform:"capitalize",letterSpacing:"inherit",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px",padding:"4px 10px","&:hover":{backgroundColor:e.palette.secondary.main}}}})),me=function(e){var t=e.text,a=e.url,n=e.onClick,r=le(),i=Object(C.h)();if(a){var o={pathname:a,state:{from:i.pathname}};return c.a.createElement(H.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,component:N.b,to:o},t)}return c.a.createElement(H.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,onClick:n},t)},ue=function(){var e=Object(r.useState)(!1),t=Object(L.a)(e,2),a=t[0],c=(t[1],Object(r.useState)(!1)),i=Object(L.a)(c,2),o=i[0],l=(i[1],Object(r.useState)("")),u=Object(L.a)(l,2),d=u[0],p=(u[1],Object(s.c)()),g=Object(C.g)(),b=Object(C.h)(),h=function(){p({type:n.LOGOUT,newStatus:m.loginStatus});var e=(b.state||{from:{pathname:"/"}}).from;g.replace(e),p(f("Logout succeeded"))};return[a,o,d,function(){h()}]},de=function(e){var t=e.username,a=ue(),n=Object(L.a)(a,4),r=n[0],i=(n[1],n[2],n[3]);return c.a.createElement(A.a,{container:!0,alignItems:"center",justify:"center",spacing:1},c.a.createElement(A.a,{item:!0},c.a.createElement(W.a,{component:"div"},c.a.createElement(U.a,null,t))),c.a.createElement(A.a,{item:!0},r?c.a.createElement(te.a,{color:"secondary",size:"1rem"}):c.a.createElement(me,{text:"Logout",onClick:i})))},pe=function(){return c.a.createElement(A.a,{container:!0,alignItems:"center",justify:"center",spacing:1},c.a.createElement(A.a,{item:!0},c.a.createElement(me,{text:"Join",url:"/register"})),c.a.createElement(A.a,{item:!0},c.a.createElement(me,{text:"Login",url:"/login"})))},fe=a(80),ge=a.n(fe),be=ge()((function(e){var t;return{root:(t={fontFamily:["Oleo Script Swash Caps","sans-serif"].join(","),fontWeight:700,fontSize:"1.5rem"},Object(O.a)(t,e.breakpoints.up("md"),{fontSize:"1.75rem"}),Object(O.a)(t,"fontStyle","normal"),Object(O.a)(t,"color","#fff"),Object(O.a)(t,"whiteSpace","nowrap"),t)}})),he=function(){var e=be();return c.a.createElement(W.a,{variant:"h1",component:"h1",className:e.root},c.a.createElement(U.a,{fontWeight:700,textAlign:"center"},c.a.createElement(N.b,{to:"/"},"Blog | XiaoxiHome")))},ve=Object(I.a)((function(e){return{headerDimension:{width:"100%",height:"80px"},root:{backgroundColor:e.palette.primary.main,position:"fixed",zIndex:e.zIndex.appBar,left:0,top:0,color:e.palette.primary.contrastText,padding:e.spacing(0,1)},placeholder:{position:"relative"},button:{backgroundColor:"rgba(255,255,255,0.5)",color:"#fff",fontWeight:700,textTransform:"capitalize","&:hover":{backgroundColor:e.palette.secondary.main}}}})),Ee=function(e){var t=e.isLogin,a=e.username,n=ve();return c.a.createElement("header",{className:"".concat(n.placeholder," ").concat(n.headerDimension)},c.a.createElement(A.a,{container:!0,alignItems:"center",justify:"center",className:"".concat(n.root," ").concat(n.headerDimension)},c.a.createElement(A.a,{item:!0,xs:6,md:4},c.a.createElement(he,null)),c.a.createElement(A.a,{item:!0,xs:1,md:4}),c.a.createElement(A.a,{item:!0,xs:5,md:4},t?c.a.createElement(de,{username:a}):c.a.createElement(pe,null))))};var xe=Object(s.b)((function(e){return{isLogin:e.loginStatus.isLogin,username:e.loginStatus.username}}))(Ee),je=a(17),Oe=a.n(je),ye=a(26),ke=a(24),we=function(){var e=Object(s.d)().getState().loginStatus.token.access;return{Authorization:"Bearer ".concat(e)}},Se=function(){var e=Object(s.d)().getState(),t=e.loginStatus.isLogin,a=e.loginStatus.token.access,r=we(),c=Object(s.c)();return function(){return new Promise(function(){var e=Object(ke.a)(Oe.a.mark((function e(i,o){var s,l,m;return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=4;break}return i(!1),e.abrupt("return");case 4:return e.next=6,fetch(Z.verifySession,{method:"POST",headers:Object(ye.a)({"Content-Type":"application/json"},r)});case 6:return s=e.sent,e.next=9,s.json();case 9:if("success"!==e.sent.status){e.next=13;break}return i(!0),e.abrupt("return");case 13:return e.next=15,fetch(Z.refresh,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:a})});case 15:return l=e.sent,e.next=18,l.json();case 18:if("success"!==(m=e.sent).status){e.next=23;break}return c((o=m.data.access,{type:n.REFRESH_TOKEN,newAccessToken:o})),i(!0),e.abrupt("return");case 23:i(!1),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),console.log(e.t0),i(!1);case 30:case"end":return e.stop()}var o}),e,null,[[0,26]])})));return function(t,a){return e.apply(this,arguments)}}())}},Ne=function(){var e=Object(s.d)().getState().loginStatus.isLogin,t=we(),a=Se(),n=Object(r.useState)(!1),c=Object(L.a)(n,2),i=c[0],o=c[1],l=Object(r.useState)(!1),m=Object(L.a)(l,2),u=m[0],d=m[1],p=Object(r.useState)(null),f=Object(L.a)(p,2),g=f[0],b=f[1];Object(r.useEffect)((function(){h()}),[e]);var h=function(){var n=Object(ke.a)(Oe.a.mark((function n(){var r,c,s;return Oe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!i){n.next=3;break}return n.abrupt("return");case 3:if(d(!1),r=!1,!e){n.next=9;break}return n.next=8,a();case 8:r=n.sent;case 9:return o(!0),n.next=12,fetch(Z.getPostList,{method:"GET",headers:r?Object(ye.a)({},t):{}});case 12:return c=n.sent,n.next=15,c.json();case 15:s=n.sent,o(!1),console.log(s),"success"===s.status?(console.log(s.data),b(s.data)):(console.log(s),d(!0)),n.next=26;break;case 21:n.prev=21,n.t0=n.catch(0),o(!1),console.log(n.t0),d(!0);case 26:case"end":return n.stop()}}),n,null,[[0,21]])})));return function(){return n.apply(this,arguments)}}();return[i,u,g]},Ce=a(210),Ie=a(220),Le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Te=function(e){var t=new Date(e),a=t.getHours()<10?"0".concat(t.getHours()):t.getHours(),n=t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes();return"".concat(t.getDate()," ").concat(Le[t.getMonth()],", ").concat(t.getFullYear()," - ").concat(a,":").concat(n)},De=a(209),_e=a(114),Pe=a.n(_e),Ae=a(87),We=a.n(Ae),Ue=a(115),Fe=a.n(Ue),Re=a(86),He=a.n(Re),Me=function(){var e=Object(C.g)(),t=Object(C.h)();return function(){e.push({pathname:"/login",state:{from:t.pathname}})}},ze=function(e,t){var a=we(),n=Se(),c=Object(r.useState)(!1),i=Object(L.a)(c,2),o=i[0],l=i[1],m=Object(r.useState)(!1),u=Object(L.a)(m,2),d=u[0],p=u[1],g=Object(r.useState)(null),b=Object(L.a)(g,2),h=b[0],v=b[1],E=Object(s.c)(),x=Me();return[o,d,h,function(){var r=Object(ke.a)(Oe.a.mark((function r(c){var i,s;return Oe.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,console.log(JSON.stringify({target_type:e,target_id:t,action:c})),!o){r.next=4;break}return r.abrupt("return");case 4:return p(!1),l(!0),r.next=8,n();case 8:if(r.sent){r.next=13;break}return l(!1),x(),r.abrupt("return");case 13:return r.next=15,fetch(Z.like,{method:"POST",headers:Object(ye.a)({"Content-Type":"application/json"},a),body:JSON.stringify({target_type:e,target_id:t,action:c})});case 15:return i=r.sent,r.next=18,i.json();case 18:s=r.sent,l(!1),"success"===s.status?v(s.data):(E(f(s.message)),p(!0)),r.next=29;break;case 23:r.prev=23,r.t0=r.catch(0),console.log(r.t0),l(!1),p(!0),E(f("Server is not available please try again later"));case 29:case"end":return r.stop()}}),r,null,[[0,23]])})));return function(e){return r.apply(this,arguments)}}()]},Be=Object(I.a)((function(e){return{likeButtons:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginLeft:"-14px"},buttonText:{lineHeight:1,color:e.palette.grey[500],fontSize:"0.875rem",fontWeight:700},button:{color:e.palette.grey[400],fontSize:"1.25rem"}}})),Je=function(e){var t=e.type,a=e.id,n=e.likes,r=e.dislikes,i=e.isLiked,o=Be(),s=ze(t,a),l=Object(L.a)(s,4),m=l[0],u=(l[1],l[2]),d=l[3];null!==u&&(n=u.likes,r=u.dislikes,void 0!==u.is_liked&&(i=u.is_liked));var p=1===i,f=-1===i;return c.a.createElement("div",{className:o.likeButtons},c.a.createElement(De.a,{"aria-label":"like ".concat(t),disabled:m,onClick:function(){d(p?0:1)}},c.a.createElement(Pe.a,{className:o.button,style:p?{color:We.a[300]}:{}})),c.a.createElement("div",{className:o.buttonText},n),c.a.createElement(De.a,{"aria-label":"dislike ".concat(t),disabled:m,onClick:function(){d(f?0:-1)}},c.a.createElement(Fe.a,{className:o.button,style:f?{color:He.a[300]}:{}})),c.a.createElement("div",{className:o.buttonText},r))},Ge=Object(I.a)((function(e){return{root:{margin:e.spacing(1,0)},paper:{width:"100%",minHeight:"100px",padding:e.spacing(2),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.primary.light},content:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},title:{margin:e.spacing(0,2),"& h2":{fontSize:"1.25rem",fontWeight:700,color:e.palette.text.primary,margin:e.spacing(0),lineHeight:1.2},"& h2:hover":{color:e.palette.primary.main}},author:{margin:e.spacing(0,2)},actionArea:Object(O.a)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",color:e.palette.grey[500],fontSize:"0.875rem",fontWeight:700},e.breakpoints.down("md"),{flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),actionItem:{margin:e.spacing(0,2)}}})),Ve=function(e){e.isLogin;var t=e.data,a=Ge();return c.a.createElement("div",{className:a.root},c.a.createElement(T.a,{className:a.paper,elevation:0},c.a.createElement(Ie.a,{variant:"rounded",className:a.avatar,src:t.owner.avatar_url},t.owner.username.charAt(0)),c.a.createElement("div",{className:a.content},c.a.createElement("div",{className:a.title},c.a.createElement(N.b,{to:"/post/".concat(t.id)},c.a.createElement("h2",null,t.title))),c.a.createElement("div",{className:a.author},c.a.createElement(W.a,{variant:"caption",component:"div"},c.a.createElement(U.a,null,t.owner.username))),c.a.createElement("div",{className:a.actionArea},c.a.createElement("div",{className:a.actionItem},c.a.createElement(Je,{type:"post",id:t.id,likes:t.likes,dislikes:t.dislikes,isLiked:t.is_liked})),c.a.createElement("div",{className:a.actionItem},"".concat(t.comments," ").concat(t.comments>1?"comments":"comment")),c.a.createElement("div",{className:a.actionItem},Te(t.created))))))},Xe=Object(I.a)((function(e){return{root:{}}})),Ke=function(e){var t,a=e.isLogin,n=Xe(),r=Ne(),i=Object(L.a)(r,3),o=i[0],s=i[1],l=i[2];return t=o?new Array(10).fill(0).map((function(e,t){return c.a.createElement(U.a,{width:"100%",my:1,borderRadius:"5px",key:t,overflow:"hidden"},c.a.createElement(Ce.a,{variant:"rect",animation:"wave",width:"100%",height:150}))})):s?c.a.createElement(W.a,{variant:"body1",component:"h2"},c.a.createElement(U.a,{fontWeight:700,color:"primary.main",textAlign:"center"},"Server is unavailable now, please try again later")):null===l||void 0===l?void 0:l.map((function(e,t){return c.a.createElement(Ve,{key:t,isLogin:a,data:e})})),c.a.createElement("div",{className:n.root},t)};var Ye=Object(s.b)((function(e){return{isLogin:e.loginStatus.isLogin}}))(Ke),$e=Object(I.a)((function(e){return{button:{backgroundColor:e.palette.primary.light,maxWidth:"100%",color:"#fff",fontWeight:700,textTransform:"capitalize",letterSpacing:"inherit",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px",padding:"4px 10px","& span":{color:"#fff"},"&:hover":{backgroundColor:e.palette.secondary.main}}}})),qe=function(e){var t=e.width,a=e.text,n=e.onClick,r=e.disabled,i=$e();return c.a.createElement(H.a,{variant:"contained",classes:{root:i.button},disableElevation:!0,onClick:n,style:{width:t},disabled:r},a)},Qe=function(e){var t=e.width,a=e.text,n=e.link,r=$e();return c.a.createElement(H.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,component:N.b,to:n,style:{width:t}},a)},Ze=Object(I.a)((function(e){return{root:Object(O.a)({width:"calc(100% - 16px)",minHeight:"100px",margin:"8px",padding:"24px 0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},e.breakpoints.down("md"),{width:"100%",margin:"8px 0"}),rowWrapper:{width:"80%",margin:"8px 0"}}})),et=function(e){var t=e.isLogin,a=Ze();return c.a.createElement(T.a,{className:a.root,elevation:0},c.a.createElement("div",{className:a.rowWrapper},c.a.createElement(Qe,{link:"/edit-post",width:"100%",text:"Create Post"})),t&&c.a.createElement("div",{className:a.rowWrapper},c.a.createElement(Qe,{link:"/account-setting",width:"100%",text:"Account Settings"})))};var tt=Object(s.b)((function(e){return{isLogin:e.loginStatus.isLogin}}))(et),at=Object(I.a)((function(e){return{root:Object(O.a)({margin:e.spacing(2,0),width:"100%",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},e.breakpoints.down("md"),{flexDirection:"column",margin:0}),left:Object(O.a)({width:"75%"},e.breakpoints.down("md"),{width:"100%"}),right:Object(O.a)({width:"25%"},e.breakpoints.down("md"),{width:"100%"})}})),nt=function(){var e=at();return c.a.createElement("div",{className:e.root},c.a.createElement("div",{className:e.left},c.a.createElement(Ye,null)),c.a.createElement("div",{className:e.right},c.a.createElement(tt,null)))},rt=a(211),ct=a(221),it=a(212),ot=a(116),st=a.n(ot),lt=ge()((function(e){return Object(rt.a)({root:{},content:{backgroundColor:e.palette.primary.main}})})),mt=function(e){var t=e.open,a=e.closeSnackbar,n=e.message,r=lt();return c.a.createElement(ct.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,autoHideDuration:5e3,onClose:a,className:r.root},c.a.createElement(it.a,{className:r.content,message:c.a.createElement(W.a,{variant:"body1",component:"div"},c.a.createElement(U.a,{fontWeight:700},n)),action:[c.a.createElement(De.a,{key:"close","aria-label":"close",color:"inherit",onClick:a},c.a.createElement(st.a,null))]}))};var ut=Object(s.b)((function(e){return{open:e.snackbar.open,message:e.snackbar.message}}),(function(e){return{closeSnackbar:function(){return e({type:d.CLOSE})}}}))(mt),dt=Object(I.a)((function(e){return{root:{listStyleType:"none",margin:0,padding:0},header:{fontSize:"1.25rem",margin:"8px 0",letterSpacing:"0",fontWeight:700},content:{fontSize:"0.875rem",padding:"2px","&:hover":{color:e.palette.secondary.main}}}})),pt=function(e){var t=e.data,a=dt();return c.a.createElement("ul",{className:a.root},t.map((function(e,t){return 0===t?c.a.createElement("li",{key:t},c.a.createElement("div",{className:a.header},e.title)):c.a.createElement("li",{key:t},c.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},c.a.createElement("div",{className:a.content},e.title)))})))},ft=[{title:"Learn More",url:""},{title:"API Endpoints",url:"https://www.google.ca/"},{title:"GitHub",url:"https://github.com/CptDoraemon/discussion-board-client"},{title:"XiaoxiHome",url:"https://www.xiaoxihome.com/"}],gt=Object(I.a)((function(e){return{root:{width:"100%",margin:"40px 0 8px 0"},paper:{width:"100%",backgroundColor:"#4a5568",color:"#a0aec0",padding:e.spacing(5)},copyright:{width:"100%",margin:e.spacing(5,0,0,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",fontSize:"0.8rem"}}})),bt=function(){var e=gt();return c.a.createElement("footer",{className:e.root},c.a.createElement(T.a,{className:e.paper},c.a.createElement(A.a,{container:!0,spacing:5},c.a.createElement(A.a,{item:!0},c.a.createElement(he,null)),c.a.createElement(A.a,{item:!0},c.a.createElement(pt,{data:ft}))),c.a.createElement("div",{className:e.copyright},c.a.createElement("div",null,"\xa9 2020 XiaoxiHome.com"))))},ht=a(2),vt=function(e){var t=e.children,a=e.isLogin,n=Object(ht.a)(e,["children","isLogin"]);return c.a.createElement(C.b,Object.assign({},n,{render:function(e){var n=e.location;return a?t:c.a.createElement(C.a,{to:{pathname:"/login",state:{from:n}}})}}))},Et=a(117),xt=a.n(Et),jt=(a(167),a(218)),Ot=a(219),yt=a(204),kt=a(206),wt=function(){var e=we(),t=Se(),a=Object(r.useState)(!1),n=Object(L.a)(a,2),c=n[0],i=n[1],o=Object(r.useState)(!1),s=Object(L.a)(o,2),l=s[0],m=s[1],u=Object(r.useState)(""),d=Object(L.a)(u,2),p=d[0],f=d[1],g=Object(r.useState)(!1),b=Object(L.a)(g,2),h=b[0],v=b[1],E=Me();return[c,l,p,function(){var a=Object(ke.a)(Oe.a.mark((function a(n,r){var o,s;return Oe.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!c&&!h){a.next=3;break}return a.abrupt("return");case 3:return m(!1),f(" "),i(!0),a.next=8,t();case 8:if(a.sent){a.next=13;break}return i(!1),E(),a.abrupt("return");case 13:return a.next=15,fetch(Z.createPost,{method:"POST",headers:Object(ye.a)({"Content-Type":"application/json"},e),body:JSON.stringify({title:n,content:r})});case 15:return o=a.sent,a.next=18,o.json();case 18:s=a.sent,i(!1),"success"===s.status?(console.log(s),v(!0)):(f(s.message),m(!0)),a.next=29;break;case 23:a.prev=23,a.t0=a.catch(0),console.log(a.t0),i(!1),f("Server is not available please try again later"),m(!0);case 29:case"end":return a.stop()}}),a,null,[[0,23]])})));return function(e,t){return a.apply(this,arguments)}}(),h]},St=Object(I.a)((function(e){return{root:{width:"100%",padding:e.spacing(2)},editor:{width:"100%",minHeight:"300px",marginBottom:"16px"},title:{width:"100%"}}})),Nt=function(){var e=St(),t=(Object(C.i)().postID,Object(r.useState)(null)),a=Object(L.a)(t,2),n=a[0],i=a[1],o=B("",K),s=Object(L.a)(o,5),l=s[0],m=s[1],u=s[2],d=s[3],p=s[4],f=wt(),g=Object(L.a)(f,5),b=g[0],h=g[1],v=g[2],E=g[3],x=g[4];return Object(r.useEffect)((function(){var e=new xt.a("#".concat("editor"),{modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"],["image","code-block"]]},placeholder:"Compose an epic...",theme:"snow"});i(e)}),[]),c.a.createElement(T.a,{className:e.root,elevation:0},c.a.createElement("form",null,c.a.createElement(jt.a,{className:e.title},c.a.createElement(Ot.a,{htmlFor:"post-editor-title"},"Title"),c.a.createElement(yt.a,{id:"post-editor-title","aria-describedby":"post-editor-title-helper-text",value:l,onChange:m}),c.a.createElement(kt.a,{id:"post-editor-title-helper-text",error:u},u&&d?d:" ")),c.a.createElement("div",{id:"editor",className:e.editor}),c.a.createElement(qe,{onClick:function(e){e.preventDefault(),p()&&E(l,n.root.innerHTML)},width:"250px",text:x?"Submitted":"Submit",disabled:x||b}),c.a.createElement(ne,{loading:b,error:h,errorMessage:v})))};var Ct=function(e){Object(r.useEffect)((function(){return document.title=e||"Blog | XiaoxiHome",function(){document.title="Blog | XiaoxiHome"}}),[e])},It=function(e){var t=Object(s.d)().getState().loginStatus.isLogin,a=we(),n=Se(),c=Object(r.useState)(!1),i=Object(L.a)(c,2),o=i[0],l=i[1],m=Object(r.useState)(!1),u=Object(L.a)(m,2),d=u[0],p=u[1],f=Object(r.useState)(null),g=Object(L.a)(f,2),b=g[0],h=g[1];Ct(null===b||void 0===b?void 0:b.title),Object(r.useEffect)((function(){v()}),[t,e]);var v=function(){var r=Object(ke.a)(Oe.a.mark((function r(){var c,i,s;return Oe.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!o){r.next=3;break}return r.abrupt("return");case 3:if(p(!1),c=!1,!t){r.next=9;break}return r.next=8,n();case 8:c=r.sent;case 9:return l(!0),r.next=12,fetch(Z.getPostDetail(e),{method:"GET",headers:c?Object(ye.a)({},a):{}});case 12:return i=r.sent,r.next=15,i.json();case 15:s=r.sent,l(!1),console.log(s),"success"===s.status?(console.log(s.data),h(s.data)):(console.log(s),p(!0)),r.next=26;break;case 21:r.prev=21,r.t0=r.catch(0),l(!1),console.log(r.t0),p(!0);case 26:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(){return r.apply(this,arguments)}}();return[o,d,b]},Lt=function(){var e=Object(C.g)(),t=Object(C.h)();return function(){e.replace("/"),e.replace(t)}},Tt=function(){var e=we(),t=Se(),a=Object(r.useState)(!1),n=Object(L.a)(a,2),c=n[0],i=n[1],o=Object(r.useState)(!1),s=Object(L.a)(o,2),l=s[0],m=s[1],u=Object(r.useState)(""),d=Object(L.a)(u,2),p=d[0],f=d[1],g=Me(),b=Lt();return[c,l,p,function(){var a=Object(ke.a)(Oe.a.mark((function a(n,r,o){var s,l;return Oe.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!c){a.next=3;break}return a.abrupt("return");case 3:return m(!1),f(" "),i(!0),a.next=8,t();case 8:if(a.sent){a.next=13;break}return i(!1),g(),a.abrupt("return");case 13:return a.next=15,fetch(Z.createComment,{method:"POST",headers:Object(ye.a)({"Content-Type":"application/json"},e),body:JSON.stringify({content:n,parent_post:r,parent_comment:o})});case 15:return s=a.sent,a.next=18,s.json();case 18:l=a.sent,i(!1),"success"===l.status?b():(console.log(l),f(l.message),m(!0)),a.next=29;break;case 23:a.prev=23,a.t0=a.catch(0),console.log(a.t0),i(!1),f("Server is not available please try again later"),m(!0);case 29:case"end":return a.stop()}}),a,null,[[0,23]])})));return function(e,t,n){return a.apply(this,arguments)}}()]},Dt=Object(I.a)((function(e){return{root:{width:"100%",margin:"16px 0"},input:{width:"100%"}}})),_t=function(e){var t=e.parentPost,a=e.parentComment,n=Dt(),r=B("",Y),i=Object(L.a)(r,5),o=i[0],s=i[1],l=i[2],m=i[3],u=i[4],d=Tt(),p=Object(L.a)(d,4),f=p[0],g=p[1],b=p[2],h=p[3];return c.a.createElement("form",{className:n.root},c.a.createElement(F.a,{id:"comment-input",label:"Leave comment",name:"comment",value:o,onChange:s,error:l,helperText:l&&m?m:" ",variant:"outlined",className:n.input}),c.a.createElement(qe,{onClick:function(e){e.preventDefault(),u()&&h(o,t,a)},width:"250px",text:"Submit",disabled:f}),g&&b&&c.a.createElement(ne,{loading:f,error:g,errorMessage:b}))},Pt=a(213),At=Object(I.a)((function(e){return{postInfo:Object(O.a)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",color:e.palette.grey[500],fontWeight:700},e.breakpoints.down("md"),{flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),avatar:{backgroundColor:e.palette.primary.main},avatarSmall:{width:"1.2rem",height:"1.2rem",fontSize:"0.8rem"},username:{color:e.palette.text.primary},postInfoItem:Object(O.a)({margin:e.spacing(0,2)},e.breakpoints.down("md"),{margin:"4px 0"})}})),Wt=function(e){var t=e.type,a=e.username,n=e.avatarUrl,r=e.created,i=e.id,o=e.likes,s=e.dislikes,l=e.isLiked,m=e.small,u=At();return c.a.createElement("div",{className:u.postInfo},c.a.createElement("div",{className:u.postInfoItem},c.a.createElement(Ie.a,{variant:"rounded",className:m?"".concat(u.avatar," ").concat(u.avatarSmall):u.avatar,src:n},a.charAt(0))),c.a.createElement("div",{className:"".concat(u.postInfoItem," ").concat(u.username)},a),c.a.createElement("div",{className:u.postInfoItem},Te(r)),c.a.createElement("div",{className:u.postInfoItem},c.a.createElement(Je,{type:t,id:i,likes:o,dislikes:s,isLiked:l})))},Ut=a(118),Ft=a.n(Ut),Rt=Object(I.a)((function(e){return{root:{width:"100%"},content:{margin:"32px"}}})),Ht=function(e){var t=e.data,a=Rt();return c.a.createElement("div",{className:a.root},c.a.createElement(Wt,{type:"comment",username:t.owner.username,avatarUrl:t.owner.avatar_url,created:t.created,id:t.id,likes:t.likes,dislikes:t.dislikes,isLiked:t.isLiked,small:!0}),c.a.createElement("div",{className:a.content},t.content))},Mt=Object(I.a)((function(e){return{root:{margin:"20px 0",width:"100%",padding:e.spacing(2)},content:{margin:"32px"},commentButton:{margin:"0 32px",color:e.palette.grey[500]},subCommentPanel:{width:"calc(100% - 32px)",margin:"8px 0 8px 32px",border:"1px solid ".concat(e.palette.grey[400]),borderRadius:"5px",padding:e.spacing(2)}}})),zt=function(e){var t=e.data,a=e.postID,n=e.isLogin,i=Mt(),o=Object(r.useState)(!1),s=Object(L.a)(o,2),l=s[0],m=s[1];return c.a.createElement(T.a,{className:i.root,elevation:0},c.a.createElement(Wt,{type:"comment",username:t.owner.username,avatarUrl:t.owner.avatar_url,created:t.created,id:t.id,likes:t.likes,dislikes:t.dislikes,isLiked:t.isLiked,small:!0}),c.a.createElement("div",{className:i.content},t.content),c.a.createElement(H.a,{variant:"outlined",className:i.commentButton,disableElevation:!0,startIcon:c.a.createElement(Ft.a,null),onClick:function(){return m((function(e){return!e}))},size:"small"},t.sub_comments.length),l&&c.a.createElement(Pt.a,{in:l,timeout:1e3},c.a.createElement("div",{className:i.subCommentPanel},!t.sub_comments.length&&c.a.createElement(U.a,{textAlign:"center"},"No comment yet"),t.sub_comments.map((function(e,t){return c.a.createElement(Ht,{data:e,key:t})})),n&&c.a.createElement(_t,{parentPost:a,parentComment:t.id}))))},Bt=Object(I.a)((function(e){return{root:{margin:"60px 0",width:"100%"},paper:{width:"100%",padding:e.spacing(4)},loginToLeaveMessage:{width:"100%",height:"200px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",fontWeight:700,color:e.palette.grey[600]}}})),Jt=function(e){var t=e.isLogin,a=e.comments,n=e.postID,r=e.data,i=Bt();return c.a.createElement("div",{className:i.root},c.a.createElement(T.a,{className:i.paper,elevation:0},c.a.createElement(W.a,{variant:"body1",component:"div"},c.a.createElement(U.a,{fontWeight:700},"".concat(a," ").concat(a>1?"comments":"comment"))),c.a.createElement(R.a,null)),r.map((function(e,a){return c.a.createElement(zt,{data:e,postID:n,key:a,isLogin:t})})),c.a.createElement(T.a,{className:i.paper,elevation:0},t?c.a.createElement(_t,{parentPost:n,parentComment:null}):c.a.createElement("div",{className:i.loginToLeaveMessage},"Login to leave a comment")))},Gt=Object(I.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",padding:e.spacing(4)},loading:{width:"100%",height:"500px"},error:{width:"100%",height:"500px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},postContent:{marginTop:"40px"}}})),Vt=function(e){var t,a=e.isLogin,n=Gt(),r=Object(C.i)().postID,i=It(parseInt(r||"1")),o=Object(L.a)(i,3),s=o[0],l=o[1],m=o[2];return s?t=c.a.createElement("div",{className:n.loading},c.a.createElement(Ce.a,{variant:"rect",width:"100%",height:60}),new Array(10).fill(0).map((function(e,t){return c.a.createElement(Ce.a,{variant:"text",width:"100%",key:t})}))):l?t=c.a.createElement("div",{className:n.error},c.a.createElement("h1",null,"Server error")):m&&(t=c.a.createElement(c.a.Fragment,null,c.a.createElement(T.a,{className:n.paper,elevation:0},c.a.createElement("h1",null," ",m.title," "),c.a.createElement(Wt,{type:"post",username:m.owner.username,avatarUrl:m.owner.avatar_url,created:m.created,id:m.id,likes:m.likes,dislikes:m.dislikes,isLiked:m.is_liked}),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:m.content},className:n.postContent})),c.a.createElement(Jt,{comments:m.comments,isLogin:a,postID:m.id,data:m.comments_data}))),c.a.createElement("div",{className:n.root},t)};function Xt(){var e=Object(C.h)().pathname;return Object(r.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var Kt=Object(I.a)((function(e){return{root:{width:"100%",minHeight:"100px"},sectionTitle:{width:"100%",padding:e.spacing(1,2),backgroundColor:e.palette.primary.light,fontWeight:700,color:"#fff"},content:{width:"100%",padding:e.spacing(2)}}})),Yt=function(e){var t=e.children,a=e.sectionTitle,n=Kt();return c.a.createElement("div",{className:n.root},c.a.createElement(W.a,{variant:"body1",component:"h3"},c.a.createElement(U.a,{className:n.sectionTitle},a)),c.a.createElement("div",{className:n.content},t))},$t=a(119),qt=a(120),Qt=a.n(qt);a(168);var Zt,ea=function(e,t,a){var n=[t.x,t.y,t.width,t.height].map((function(e){return void 0===e?1:e})),r=Object(L.a)(n,4),c=r[0],i=r[1],o=r[2],s=r[3],l=document.createElement("canvas"),m=e.naturalWidth/e.width,u=e.naturalHeight/e.height;l.width=800,l.height=800;var d=l.getContext("2d");return null===d||void 0===d||d.drawImage(e,c*m,i*u,o*m,s*u,0,0,800,800),new Promise((function(e,t){l.toBlob((function(t){console.log(t),t&&e(t)}),"image/jpeg",1)}))},ta=function(){var e=we(),t=Object(r.useState)(!1),a=Object(L.a)(t,2),n=a[0],c=a[1],i=Object(r.useState)(!1),o=Object(L.a)(i,2),s=o[0],l=o[1],m=Object(r.useState)(""),u=Object(L.a)(m,2),d=u[0],p=u[1];Lt();return[n,s,d,function(t){return new Promise((function(a,r){if(n)r();else{l(!1),p(""),c(!0);var i=new FormData;i.append("image",t,"avatar.jpg"),fetch(Z.updateAvatar,{method:"POST",headers:Object(ye.a)({},e),body:i}).then((function(e){return e.json()})).then((function(e){c(!1),console.log(e),"success"!==e.status?(l(!0),"error"===e.status?p(e.message):p("Server unavailable, please try again later."),r()):a(!0)})).catch((function(e){c(!1),l(!0),p("Server unavailable, please try again later."),r()}))}}))}]};!function(e){e.UPLOAD="UPLOAD",e.CROP="CROP",e.CONFIRM="CONFIRM",e.FINISH="FINISH"}(Zt||(Zt={}));var aa=Object(I.a)((function(e){return{root:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},row:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},backNextButtons:{width:"100%",margin:e.spacing(1,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},image:Object(O.a)({width:"500px"},e.breakpoints.down("md"),{width:"100%"}),centering:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})),na=function(e){var t=e.restart,a=aa();return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:a.backNextButtons},c.a.createElement(qe,{onClick:t,width:"150px",text:"Start Again"})),c.a.createElement("div",null,"All set"))},ra=function(e){var t=e.blob,a=e.back,n=e.next,r=aa(),i=ta(),o=Object(L.a)(i,4),s=o[0],l=o[1],m=o[2],u=o[3],d=function(){var e=Object(ke.a)(Oe.a.mark((function e(){return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,u(t);case 4:e.sent&&n();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:r.backNextButtons},c.a.createElement(U.a,null,c.a.createElement(qe,{onClick:a,width:"150px",text:"Redo Cropping"})),c.a.createElement(U.a,null,c.a.createElement(qe,{onClick:d,width:"150px",text:"Update Avatar",disabled:s}))),c.a.createElement(ne,{loading:s,error:l,errorMessage:m}),c.a.createElement("div",{className:r.centering},c.a.createElement("img",{src:URL.createObjectURL(t),className:r.image})))},ca=function(e){var t=e.src,a=e.back,n=e.next,i=aa(),o=Object(r.useState)(!1),s=Object(L.a)(o,2),l=s[0],m=s[1],u=Object(r.useState)(null),d=Object(L.a)(u,2),p=d[0],f=d[1],g=Object(r.useState)({aspect:1,unit:"%",height:100,x:25}),b=Object(L.a)(g,2),h=b[0],v=b[1],E=function(){var e=Object(ke.a)(Oe.a.mark((function e(){var t;return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log(p),p){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,ea(p,h," ");case 6:t=e.sent,console.log(t),t&&n(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:i.backNextButtons},c.a.createElement(U.a,{justifySelf:"flex-start"},c.a.createElement(qe,{onClick:a,width:"150px",text:"Repick"})),c.a.createElement(U.a,{justifySelf:"flex-end"},c.a.createElement(qe,{onClick:E,width:"150px",text:"Crop"}))),c.a.createElement(Qt.a,{src:t,crop:h,onChange:function(e){return v(e)},className:i.image,ruleOfThirds:!0,onImageError:function(){return m(!0)},onImageLoaded:function(e){return f(e)}}),l&&c.a.createElement(ne,{loading:!1,error:!0,errorMessage:"Image can't be loaded"}))},ia=function(e){var t=e.next,a=aa(),n=Object(r.useRef)(null),i=Object(r.useState)(""),o=Object(L.a)(i,2),s=(o[0],o[1],function(){if(n.current&&n.current.files&&n.current.files.length){var e=n.current.files;t(URL.createObjectURL(e[0]))}});return Object(r.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.addEventListener("change",s)}),[]),c.a.createElement("div",{style:{width:"100%"}},c.a.createElement("div",{className:a.centering},c.a.createElement(U.a,null,c.a.createElement(qe,{onClick:function(){var e;null===(e=n.current)||void 0===e||e.click()},width:"150px",text:"Upload From Disk"})),c.a.createElement("input",{type:"file",ref:n,accept:"image/*",style:{display:"none"}})))},oa=function(e){Object($t.a)(e);var t,a=aa(),n=Object(r.useState)(Zt.UPLOAD),i=Object(L.a)(n,2),o=i[0],s=i[1],l=Object(r.useState)(""),m=Object(L.a)(l,2),u=m[0],d=m[1],p=Object(r.useState)(null),f=Object(L.a)(p,2),g=f[0],b=f[1],h=function(){s(Zt.UPLOAD)},v=function(e){d(e),s(Zt.CROP)};switch(o){case Zt.UPLOAD:t=c.a.createElement(ia,{next:v});break;case Zt.CROP:t=c.a.createElement(ca,{src:u,back:h,next:function(e){b(e),s(Zt.CONFIRM)}});break;case Zt.CONFIRM:t=c.a.createElement(ra,{blob:g,back:function(){s(Zt.CROP)},next:function(){s(Zt.FINISH)}});break;case Zt.FINISH:t=c.a.createElement(na,{restart:h});break;default:t=c.a.createElement(ia,{next:v})}return c.a.createElement("div",{className:a.root},t)},sa=Object(I.a)((function(e){return{root:{margin:e.spacing(1,0),width:"100%"},paper:{width:"100%",minHeight:"100px",overflow:"hidden"}}})),la=function(e){var t=e.username,a=sa();return c.a.createElement("div",{className:a.root},c.a.createElement(W.a,{variant:"body1",component:"h2"},c.a.createElement(U.a,{my:2,fontWeight:700},t)),c.a.createElement(T.a,{className:a.paper,elevation:0},c.a.createElement(Yt,{sectionTitle:"Avatar"},c.a.createElement(oa,null))))};var ma=Object(s.b)((function(e){return{username:e.loginStatus.username}}))(la),ua=Object(I.a)((function(e){return{root:{width:"100%",maxWidth:"100vw",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},widthWrapper:Object(O.a)({margin:e.spacing(5,0,0,0),width:"1000px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},e.breakpoints.down("sm"),{width:"calc(100% - 16px)",margin:e.spacing(0,1)})}}));var da=Object(s.b)((function(e){return{isLogin:e.loginStatus.isLogin}}))((function(e){var t=e.isLogin,a=ua();return c.a.createElement("div",{className:a.root},c.a.createElement(N.a,{basename:"/discussion-board-client"},c.a.createElement(Xt,null),c.a.createElement(xe,null),c.a.createElement("div",{className:a.widthWrapper},c.a.createElement(C.d,null,c.a.createElement(C.b,{path:"/",exact:!0,render:function(){return c.a.createElement(nt,null)}}),c.a.createElement(C.b,{path:"/login",render:function(){return c.a.createElement(ce,null)}}),c.a.createElement(C.b,{path:"/register",render:function(){return c.a.createElement(se,null)}}),c.a.createElement(C.b,{path:"/post/:postID",render:function(){return c.a.createElement(Vt,{isLogin:t})}}),c.a.createElement(vt,{path:"/edit-post/:postID?",isLogin:t},c.a.createElement(Nt,null)),c.a.createElement(vt,{path:"/account-setting",isLogin:t},c.a.createElement(ma,null))),c.a.createElement(bt,null))),c.a.createElement(ut,null))})),pa=Object(l.d)(b,m,Object(l.a)(v)),fa=function(){return c.a.createElement(s.a,{store:pa},c.a.createElement(j.a,{theme:S},c.a.createElement(x.a,null),c.a.createElement(da,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(fa,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[132,1,2]]]);
//# sourceMappingURL=main.6e586bb3.chunk.js.map