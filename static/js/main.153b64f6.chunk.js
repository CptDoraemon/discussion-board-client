(this["webpackJsonpdiscussion-board-client"]=this["webpackJsonpdiscussion-board-client"]||[]).push([[0],{178:function(e,t,a){e.exports=a(235)},183:function(e,t,a){},235:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),o=a(15),c=a.n(o),l=(a(183),a(18)),s=a(49),u=a(112),m={loginStatus:{isLogin:!1,username:"",token:{access:"",refresh:""}},snackbar:{open:!1,message:""},confetti:!1};function d(e){return{type:n.UPDATE_LOGIN_STATUS,newStatus:e}}!function(e){e.UPDATE_LOGIN_STATUS="UPDATE_LOGIN_STATUS",e.LOGOUT="LOGOUT",e.REFRESH_TOKEN="REFRESH_TOKEN"}(n||(n={}));var p,f,g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.loginStatus,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.UPDATE_LOGIN_STATUS:case n.LOGOUT:return t.newStatus;case n.REFRESH_TOKEN:var a=Object.assign({},e);return a.token.access=t.newAccessToken,a;default:return e}};function h(){return function(e){e({type:p.OPEN_CONFETTI}),window.setTimeout((function(){return e({type:p.CLOSE_CONFETTI})}),2e3)}}function b(e){return function(t){t(v(e)),window.setTimeout((function(){return t(h())}),300)}}function v(e){return{type:f.OPEN_SNACKBAR,message:e}}!function(e){e.CLOSE_CONFETTI="CLOSE_CONFETTI",e.OPEN_CONFETTI="OPEN_CONFETTI"}(p||(p={})),function(e){e.CLOSE_SNACKBAR="CLOSE_SNACKBAR",e.OPEN_SNACKBAR="OPEN_SNACKBAR"}(f||(f={}));var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.snackbar,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.OPEN_SNACKBAR:return{open:!0,message:t.message};case f.CLOSE_SNACKBAR:return m.snackbar;default:return e}};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.confetti,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.OPEN_CONFETTI:return!0;case p.CLOSE_CONFETTI:return!1;default:return e}},j=Object(s.c)({loginStatus:g,snackbar:E,confetti:x}),O=a(148),y=Object(O.createLogger)();var w=a(296),k=a(286),S=a(162),C=a(301),N=Object(S.a)({palette:{primary:{main:"#41b3a3",contrastText:"#fff"},secondary:{main:"#e8a87c",contrastText:"#fff"},text:{primary:"#4a5568"},background:{default:"rgb(241, 242, 245)"}},typography:{fontFamily:"system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",fontSize:14,fontWeightLight:300,fontWeightRegular:400,fontWeightMedium:500}}),I=N=Object(C.a)(N),L=a(20),T=a(14),P=a(22),D=a(275),R=a(4),_=a(237),M=function(e){var t=Object(r.useState)(0),a=Object(R.a)(t,2),n=a[0],i=a[1];return Object(r.useEffect)((function(){e.current&&i(e.current.getBoundingClientRect().height)}),[e]),n},W=Object(D.a)((function(e){return{root:{width:"100%",margin:e.spacing(2,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",overflow:"hidden"},image:Object(L.a)({width:"40%",height:"0","& img":{width:"100%",height:"100%",objectFit:"cover"}},e.breakpoints.down("sm"),{display:"none"}),content:Object(L.a)({width:"60%",padding:e.spacing(10,5)},e.breakpoints.down("sm"),{width:"100%"}),textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),A=function(e){var t=e.children,a=e.imageUrl,n=W(),o=Object(r.useRef)(null),c=M(o);return i.a.createElement(_.a,{elevation:0,className:n.root,ref:o},i.a.createElement("div",{className:n.image,style:{height:"".concat(c,"px")}},i.a.createElement("img",{src:"/discussion-board-client"+a,alt:"login background",title:"login background"})),i.a.createElement("div",{className:n.content},t))},z=a(280),F=a(164),U=a(302),B=a(281),H=a(284),G=a(277),K=Object(D.a)((function(e){return{button:{width:"100%",backgroundColor:e.palette.primary.main,color:"#fff",fontWeight:700,textTransform:"none",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px","&:hover":{backgroundColor:e.palette.secondary.main},"&:disabled":{backgroundColor:e.palette.secondary.main,opacity:.7}}}})),V=function(e){var t=e.text,a=e.disabled,n=e.form,r=K();return i.a.createElement(G.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,type:"submit",form:n,disabled:a},t)},J=function(e,t){var a=Object(r.useState)(e),n=Object(R.a)(a,2),i=n[0],o=n[1],c=Object(r.useState)(!1),l=Object(R.a)(c,2),s=l[0],u=l[1],m=Object(r.useState)(""),d=Object(R.a)(m,2),p=d[0],f=d[1];return[i,function(e){s&&u(!1),o(e.target.value)},s,p,function(e){var a=e?t(i,e):t(i);return u(!a.isValid),f(a.message),a.isValid}]},X=function(e){var t=!0,a="";return e.length>=30?(t=!0,a="Username length must be less than 30 characters"):0===e.length&&(t=!0,a="Username cannot be empty"),{isValid:t,message:a}},$=function(e){var t=!0,a="";return-1===e.indexOf("@")||-1===e.indexOf(".")?(t=!1,a="Invalid Email format"):0===e.length?(t=!1,a="Email cannot be empty"):e.length>=60&&(t=!1,a="Email too long"),{isValid:t,message:a}},q=function(e){var t=!0,a="";return 0===e.length&&(t=!1,a="Email cannot be empty"),{isValid:t,message:a}},Y=function(e,t){var a=!0,n="";return e!==t&&(n="Not same as the password",a=!1),{isValid:a,message:n}},Q=function(e){var t=!0,a="";return 0===e.length&&(a="Title cannot be empty",t=!1),{isValid:t,message:a}},Z=function(e){var t=!0,a="";return 0===e.length?(a="Comment cannot be empty",t=!1):e.length<5&&(a="Comment needs to be at least 5 characters",t=!1),{isValid:t,message:a}},ee=function(e){for(var t=e.map((function(e){return e()})),a=0;a<t.length;a++)if(!t[a])return!1;return!0},te="https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/",ae=te+"post/",ne={login:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/login/",register:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/register/",verifySession:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/verify_session/",refresh:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/refresh/",updateAvatar:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/account/update_avatar/",getPostList:function(e){var t=e.tag,a=e.page,n=ae+"all/?page=".concat(a);return t&&(n+="&tag=".concat(t)),n},popularPosts:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/post/all/?sort_by=view_count&limit=5",getPostDetail:function(e){return"".concat(ae).concat(e,"/")},createPost:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/post/create/",editPost:function(e){return"".concat(ae,"edit/").concat(e,"/")},deletePost:function(e){return"".concat(ae,"delete/").concat(e,"/")},tagList:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/post/tag-list/",createComment:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/comment/create/",like:"https://django-api-xiaoxihome.herokuapp.com/api/discussion_board/user_actions/like/"},re=["/login","/register"],ie=function(){var e=Object(P.g)(),t=Object(P.h)();return function(){var a="/";t.state&&t.state.from&&("string"===typeof t.state.from?-1===re.indexOf(t.state.from)&&(a=t.state.from):t.state.from.pathname&&-1===re.indexOf(t.state.from.pathname)&&(a=Object.assign({},t.state.from))),e.replace(a)}},oe=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(!1),o=Object(R.a)(i,2),c=o[0],s=o[1],u=Object(r.useState)(""),m=Object(R.a)(u,2),p=m[0],f=m[1],g=Object(l.c)(),h=ie();return[a,c,p,function(e,t){a||(s(!1),f(""),n(!0),fetch(ne.login,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(n(!1),"success"===e.status){var t=e.data.username;g(d({isLogin:!0,username:t,token:{access:e.data.access,refresh:e.data.refresh}})),h(),g(b("Welcome back ".concat(t)))}else s(!0),"error"===e.status?f(e.message):f("Server unavailable, please try again later.")})).catch((function(e){n(!1),s(!0),f("Server unavailable, please try again later.")})))}]},ce=a(279),le=Object(D.a)((function(e){return{errorMessage:{fontWeight:700,color:e.palette.error.main}}})),se=function(e){var t=e.loading,a=e.errorMessage,n=e.error,r=e.spinnerSize,o=le();return i.a.createElement(F.a,{variant:"body1",component:"div"},i.a.createElement(U.a,{className:o.errorMessage,height:40},t?i.a.createElement(ce.a,{color:"primary",size:r||40}):n&&a?a:" "))},ue=Object(D.a)((function(e){return{textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),me=function(){var e=ue(),t=J("",$),a=Object(R.a)(t,5),n=a[0],r=a[1],o=a[2],c=a[3],l=a[4],s=J("",q),u=Object(R.a)(s,5),m=u[0],d=u[1],p=u[2],f=u[3],g=u[4],h=oe(),b=Object(R.a)(h,4),v=b[0],E=b[1],x=b[2],j=b[3];return i.a.createElement(A,{imageUrl:"/images/login_bg.jpg"},i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),ee([l,g])&&j(n,m)},id:"login-form"},i.a.createElement(z.a,{container:!0,spacing:2},i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(F.a,{variant:"h5",component:"h1",color:"textPrimary"},i.a.createElement(U.a,{textAlign:"center",fontWeight:700},"Log In"))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:o,label:"Email",id:"login-email",name:"email",value:n,onChange:r,variant:"outlined",helperText:o?c:" ",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:p,type:"password",label:"Password",id:"login-password",name:"password",value:m,onChange:d,variant:"outlined",helperText:p?f:" ",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(V,{text:"Log me in!",form:"login-form",disabled:v}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(se,{loading:v,error:E,errorMessage:x}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(H.a,null)),i.a.createElement(z.a,{item:!0,xs:12,className:e.link},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(T.b,{to:"/register"},"Need an account?"))))))},de=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(!1),o=Object(R.a)(i,2),c=o[0],s=o[1],u=Object(r.useState)(""),m=Object(R.a)(u,2),p=m[0],f=m[1],g=Object(l.c)(),h=ie();return[a,c,p,function(e,t,r,i){a||(s(!1),f(""),n(!0),fetch(ne.register,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r,confirm_password:i})}).then((function(e){return e.json()})).then((function(t){n(!1),"success"===t.status?(g(d({isLogin:!0,username:t.data.username,token:{access:t.data.access,refresh:t.data.refresh}})),h(),g(b("Welcome ".concat(e,"!")))):(s(!0),"error"===t.status?f(t.message):f("Server unavailable, please try again later."))})).catch((function(e){n(!1),s(!0),f("Server unavailable, please try again later.")})))}]},pe=a(297),fe=Object(D.a)((function(e){return{textField:{width:"100%",fontWeight:700},link:{fontWeight:700,"& a:link":{color:e.palette.primary.main},"& a:visited":{color:e.palette.primary.main},"& a:hover":{color:e.palette.secondary.main}}}})),ge=function(){var e=fe(),t=J("",X),a=Object(R.a)(t,5),n=a[0],r=a[1],o=a[2],c=a[3],l=(a[4],J("",$)),s=Object(R.a)(l,5),u=s[0],m=s[1],d=s[2],p=s[3],f=(s[4],J("",q)),g=Object(R.a)(f,5),h=g[0],b=g[1],v=g[2],E=g[3],x=(g[4],J("",Y)),j=Object(R.a)(x,5),O=j[0],y=j[1],w=j[2],k=j[3],S=(j[4],de()),C=Object(R.a)(S,4),N=C[0],I=C[1],L=C[2];C[3];return i.a.createElement(A,{imageUrl:"/images/register_bg.jpg"},i.a.createElement("form",{onSubmit:function(){return!1},id:"register-form"},i.a.createElement(z.a,{container:!0,spacing:2},i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(F.a,{variant:"h5",component:"h1",color:"textPrimary"},i.a.createElement(U.a,{textAlign:"center",fontWeight:700},"Join Us"))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:o,label:"Username",id:"register-username",name:"username",value:n,onChange:r,helperText:o?c:" ",variant:"outlined",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:d,label:"Email",id:"register-email",name:"email",value:u,onChange:m,helperText:d?p:" ",variant:"outlined",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12,md:6},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:v,label:"Password",name:"password",id:"register-password",type:"password",value:h,onChange:b,helperText:v?E:" ",variant:"outlined",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12,md:6},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(B.a,{error:w,label:"Confirm Password",name:"confirm-password",id:"register-confirm-password",type:"password",value:O,onChange:y,helperText:w?k:" ",variant:"outlined",className:e.textField}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(U.a,{mb:2},i.a.createElement(pe.a,{severity:"info"},"Signing up is disabled at the moment")),i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(V,{text:"I'm in!",form:"register-form",disabled:!0}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(se,{loading:N,error:I,errorMessage:L}))),i.a.createElement(z.a,{item:!0,xs:12},i.a.createElement(H.a,null)),i.a.createElement(z.a,{item:!0,xs:12,className:e.link},i.a.createElement(z.a,{container:!0,justify:"center"},i.a.createElement(T.b,{to:"/login"},"Already have an account?"))))))},he=Object(D.a)((function(e){return{button:{backgroundColor:"rgba(255,255,255,0.3)",color:"#fff",fontWeight:700,textTransform:"capitalize",letterSpacing:"inherit",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px",padding:"4px 10px","&:hover":{backgroundColor:e.palette.secondary.main}}}})),be=function(e){var t=e.text,a=e.url,n=e.onClick,r=he(),o=Object(P.h)();if(a){var c={pathname:a,state:{from:o.pathname}};return i.a.createElement(G.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,component:T.b,to:c},t)}return i.a.createElement(G.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,onClick:n},t)},ve=function(){var e=Object(P.g)();return function(){e.replace("/404"),e.replace("/")}},Ee=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],i=(t[1],Object(l.c)()),o=ve(),c=function(){i({type:n.LOGOUT,newStatus:m.loginStatus}),o(),i(v("Logout succeeded"))};return[a,function(){c()}]},xe=function(e){var t=e.username,a=Ee(),n=Object(R.a)(a,2),r=n[0],o=n[1];return i.a.createElement(z.a,{container:!0,alignItems:"center",justify:"center",spacing:1},i.a.createElement(z.a,{item:!0},i.a.createElement(F.a,{component:"div"},i.a.createElement(U.a,null,t))),i.a.createElement(z.a,{item:!0},r?i.a.createElement(ce.a,{color:"secondary",size:"1rem"}):i.a.createElement(be,{text:"Logout",onClick:o})))},je=function(){return i.a.createElement(z.a,{container:!0,alignItems:"center",justify:"center",spacing:1},i.a.createElement(z.a,{item:!0},i.a.createElement(be,{text:"Join",url:"/register"})),i.a.createElement(z.a,{item:!0},i.a.createElement(be,{text:"Login",url:"/login"})))},Oe=a(63),ye=a.n(Oe),we=ye()((function(e){return{root:Object(L.a)({fontFamily:["Oleo Script Swash Caps","sans-serif"].join(","),fontWeight:700,fontSize:"1.75rem",fontStyle:"normal",color:e.palette.primary.contrastText,whiteSpace:"nowrap",width:"fit-content"},e.breakpoints.down("sm"),{fontSize:"1.25rem"}),link:{"&:hover":{color:e.palette.secondary.light}}}})),ke=function(){var e=we();return i.a.createElement(F.a,{variant:"h1",component:"h1",className:e.root},i.a.createElement(U.a,{fontWeight:700,textAlign:"center"},i.a.createElement(T.b,{to:"/",className:e.link},"Blog | XiaoxiHome")))},Se=Object(D.a)((function(e){return{headerDimension:{width:"100%",height:"80px"},root:{width:"100%",height:"80px",backgroundColor:e.palette.primary.main,position:"fixed",zIndex:e.zIndex.appBar,left:0,top:0,color:e.palette.primary.contrastText,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},placeholder:{position:"relative"},widthWrapper:Object(L.a)({width:e.breakpoints.values.md,height:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",padding:e.spacing(0,1)},e.breakpoints.down("sm"),{width:"100%"}),logo:{flex:1},buttonGroup:{},button:{backgroundColor:"rgba(255,255,255,0.5)",color:"#fff",fontWeight:700,textTransform:"capitalize","&:hover":{backgroundColor:e.palette.secondary.main}}}})),Ce=function(e){var t=e.isLogin,a=e.username,n=Se();return i.a.createElement("header",{className:"".concat(n.placeholder," ").concat(n.headerDimension)},i.a.createElement("div",{className:"".concat(n.root," ").concat(n.headerDimension)},i.a.createElement("div",{className:n.widthWrapper},i.a.createElement("div",{className:n.logo},i.a.createElement(ke,null)),i.a.createElement("div",{className:n.buttonGroup},t?i.a.createElement(xe,{username:a}):i.a.createElement(je,null)))))};var Ne=Object(l.b)((function(e){return{isLogin:e.loginStatus.isLogin,username:e.loginStatus.username}}))(Ce),Ie=a(17),Le=a.n(Ie),Te=a(25),Pe="Server is not available right now, please try again later",De=a(30),Re=function(){var e=Object(P.g)(),t=Object(P.h)();return function(){e.push({pathname:"/login",state:{from:t.pathname}})}},_e=function(){var e=Object(l.d)().getState(),t=e.loginStatus.isLogin,a=e.loginStatus.token.refresh,r=Object(l.c)(),i=Re(),o=function(t){return{Authorization:"Bearer ".concat(t||e.loginStatus.token.access)}};return function(){var e=Object(Te.a)(Le.a.mark((function e(c,l,s){var u,m,d,p,f;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!==s.headers&&(u=s.headers).Authorization&&(delete u.Authorization,s.headers=Object(De.a)({},u)),m=function(){return c?new Promise((function(e,t){i()})):fetch(l,Object(De.a)({},s))},t){e.next=5;break}return e.abrupt("return",m());case 5:return e.next=7,fetch(ne.verifySession,{method:"POST",headers:Object(De.a)({"Content-Type":"application/json"},o())});case 7:return d=e.sent,e.next=10,d.json();case 10:if("success"!==e.sent.status){e.next=14;break}return s.headers=Object(De.a)(Object(De.a)({},s.headers),o()),e.abrupt("return",fetch(l,Object(De.a)({},s)));case 14:return e.next=16,fetch(ne.refresh,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:a})});case 16:return p=e.sent,e.next=19,p.json();case 19:if("success"!==(f=e.sent).status){e.next=24;break}return r((g=f.data.access,{type:n.REFRESH_TOKEN,newAccessToken:g})),s.headers=Object(De.a)(Object(De.a)({},s.headers),o(f.data.access)),e.abrupt("return",fetch(l,Object(De.a)({},s)));case 24:return e.abrupt("return",m());case 27:return e.prev=27,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",new Promise((function(t,a){a(e.t0.messages)})));case 31:case"end":return e.stop()}var g}),e,null,[[0,27]])})));return function(t,a,n){return e.apply(this,arguments)}}()},Me=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(""),o=Object(R.a)(i,2),c=o[0],l=o[1],s=Object(r.useState)(null),u=Object(R.a)(s,2),m=u[0],d=u[1],p=""!==c,f=Object(r.useCallback)((function(){l("")}),[]);return{loading:a,setLoading:n,errorMessage:c,setErrorMessage:l,data:m,setData:d,error:p,resetError:f}},We=function(e,t){var a=Me(),n=a.loading,r=a.setLoading,i=a.errorMessage,o=a.setErrorMessage,c=a.data,l=a.setData,s=a.error,u=a.resetError,m=_e();function d(){return(d=Object(Te.a)(Le.a.mark((function e(t,a){var i,c;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=3;break}return e.abrupt("return");case 3:return u(),r(!0),e.next=7,m(a,t,{});case 7:return i=e.sent,e.next=10,i.json();case 10:"success"===(c=e.sent).status?l(c.data):"error"===c.status?o(c.message||Pe):o(Pe),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),o(Pe);case 18:return e.prev=18,r(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,14,18,21]])})))).apply(this,arguments)}return{loading:n,error:s,errorMessage:i,data:c,doGet:function(e,t){return d.apply(this,arguments)}}},Ae=a(287),ze=function(e){var t=e.tag,a=e.page,n=ne.getPostList({tag:t,page:a}),i=We(n,!1),o=i.loading,c=i.error,l=i.data,s=i.doGet,u=Object(Ae.a)(t),m=Object(Ae.a)(a);return Object(r.useEffect)((function(){t===u&&a===m||s(n,!1)})),[o,c,l]},Fe=a(289),Ue=a(304),Be=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],He=function(e){var t=new Date(e),a=t.getHours()<10?"0".concat(t.getHours()):t.getHours(),n=t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes();return"".concat(t.getDate()," ").concat(Be[t.getMonth()],", ").concat(t.getFullYear()," - ").concat(a,":").concat(n)},Ge=a(285),Ke=a(152),Ve=a.n(Ke),Je=a(110),Xe=a.n(Je),$e=a(153),qe=a.n($e),Ye=a(109),Qe=a.n(Ye),Ze=function(){var e=_e(),t=Object(r.useState)(!1),a=Object(R.a)(t,2),n=a[0],i=a[1],o=Object(r.useState)(!1),c=Object(R.a)(o,2),l=c[0],s=c[1],u=Object(r.useState)(""),m=Object(R.a)(u,2),d=m[0],p=m[1],f=Object(r.useState)(null),g=Object(R.a)(f,2),h=g[0],b=g[1];return{loading:n,error:l,errorMessage:d,data:h,doPost:function(){var t=Object(Te.a)(Le.a.mark((function t(a,r,o,c,l,u){var m,d;return Le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n){t.next=3;break}return t.abrupt("return");case 3:return s(!1),p(""),i(!0),t.next=8,e(o,a,Object(De.a)({},r));case 8:return m=t.sent,t.next=11,m.json();case 11:d=t.sent,i(!1),"success"===d.status?(b(d.data),c&&c(d.data)):"error"===d.status?(p(d.message),s(!0),l&&l(d.message)):(p(Pe),s(!0),u&&u()),t.next=23;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0),i(!1),p(Pe),s(!0),u&&u();case 23:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,a,n,r,i,o){return t.apply(this,arguments)}}()}},et=function(e,t){var a=Object(l.c)(),n=Ze(),r=n.loading,i=n.error,o=n.data,c=n.doPost;return[r,i,o,function(){var n=Object(Te.a)(Le.a.mark((function n(r){var i,o,l;return Le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({target_type:e,target_id:t,action:r})},o=function(e){a(v(e||Pe))},l=function(){a(v(Pe))},c(ne.like,i,!0,null,o,l);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()]},tt=Object(D.a)((function(e){return{likeButtons:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginLeft:"-14px"},buttonText:{lineHeight:1,color:e.palette.grey[500],fontSize:"0.875rem",fontWeight:700},button:{color:e.palette.grey[400],fontSize:"1.25rem"}}})),at=function(e){var t=e.type,a=e.id,n=e.likes,r=e.dislikes,o=e.isLiked,c=tt(),l=et(t,a),s=Object(R.a)(l,4),u=s[0],m=(s[1],s[2]),d=s[3];null!==m&&(n=m.likes,r=m.dislikes,void 0!==m.is_liked&&(o=m.is_liked));var p=1===o,f=-1===o;return i.a.createElement("div",{className:c.likeButtons},i.a.createElement(Ge.a,{"aria-label":"like ".concat(t),disabled:u,onClick:function(){d(p?0:1)}},i.a.createElement(Ve.a,{className:c.button,style:p?{color:Xe.a[300]}:{}})),i.a.createElement("div",{className:c.buttonText},n),i.a.createElement(Ge.a,{"aria-label":"dislike ".concat(t),disabled:u,onClick:function(){d(f?0:-1)}},i.a.createElement(qe.a,{className:c.button,style:f?{color:Qe.a[300]}:{}})),i.a.createElement("div",{className:c.buttonText},r))},nt=a(48),rt=a(303),it=function(e){var t=e.text,a=e.to,n=e.classes;return i.a.createElement("div",{className:n.root},i.a.createElement(rt.a,{label:t,component:T.b,to:a,clickable:!0,classes:{clickable:n.chipRoot,label:n.chipLabel}}))},ot=Object(D.a)((function(e){return{root:{color:e.palette.primary.contrastText},chipRoot:{borderRadius:2,height:"auto",backgroundColor:Object(nt.fade)(e.palette.primary.light,.8),transitions:e.transitions.create("background-color"),"&:hover, &:focus, &:active":{backgroundColor:e.palette.primary.main}},chipLabelSmall:{padding:"0 5px",fontSize:e.typography.caption.fontSize},chipLabelNormal:{padding:"2px 15px",fontSize:e.typography.caption.fontSize,fontWeight:700}}})),ct=function(e){var t=e.text,a=e.size,n=ot(),r={root:n.root,chipRoot:n.chipRoot,chipLabel:"small"===a?n.chipLabelSmall:n.chipLabelNormal};return i.a.createElement(it,{text:t.toUpperCase(),classes:r,to:"/?tag=".concat(t.toUpperCase())})},lt=Object(D.a)((function(e){return{root:{margin:e.spacing(1,0)},paper:{width:"100%",minHeight:"100px",padding:e.spacing(2),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.primary.light},content:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},title:{margin:e.spacing(0,2),"& h2":{fontSize:"1.25rem",fontWeight:700,color:e.palette.text.primary,margin:e.spacing(0),lineHeight:1.2},"& h2:hover":{color:e.palette.primary.main}},author:{margin:e.spacing(0,2)},actionArea:Object(L.a)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",color:e.palette.grey[500],fontSize:"0.875rem",fontWeight:700},e.breakpoints.down("md"),{flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),actionItem:{margin:e.spacing(0,2)}}})),st=function(e){var t=e.isLogin,a=e.data,n=lt(),r=t?a.is_liked:void 0;return i.a.createElement("div",{className:n.root},i.a.createElement(_.a,{className:n.paper,elevation:0},i.a.createElement(Ue.a,{variant:"rounded",className:n.avatar,src:a.owner.avatar_url},a.owner.username.charAt(0)),i.a.createElement("div",{className:n.content},i.a.createElement("div",{className:n.title},i.a.createElement(T.b,{to:"/post/".concat(a.id)},i.a.createElement("h2",null,a.title))),i.a.createElement("div",{className:n.author},i.a.createElement(F.a,{variant:"caption",component:"div"},i.a.createElement(U.a,null,a.owner.username))),i.a.createElement("div",{className:n.author},i.a.createElement(ct,{text:a.tag,size:"small"})),i.a.createElement("div",{className:n.actionArea},i.a.createElement("div",{className:n.actionItem},i.a.createElement(at,{type:"post",id:a.id,likes:a.likes,dislikes:a.dislikes,isLiked:r})),i.a.createElement("div",{className:n.actionItem},"".concat(a.comments," ").concat(a.comments>1?"comments":"comment")),i.a.createElement("div",{className:n.actionItem},He(a.created))))))},ut=a(11),mt=a(98),dt=a.n(mt),pt=a(288),ft=null,gt=ye()((function(e){return{root:{width:"100%",backgroundColor:e.palette.warning.light,color:e.palette.warning.contrastText,padding:e.spacing(1,2),margin:e.spacing(1,0,0,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},text:{width:"calc(100% - 50px)"},button:{width:"50px"},noWrap:{whiteSpace:"nowrap"},link:{"&:link":{textDecoration:"underline",fontWeight:700},"&:visited":{textDecoration:"underline",fontWeight:700},"&:hover":{color:Object(ut.c)(e.palette.warning.contrastText,.5)}}}})),ht=function(e){var t=e.isLoaded,a=gt(),n=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(!1),o=Object(R.a)(i,2),c=o[0],l=o[1],s=function(){null!==ft&&(clearTimeout(ft),ft=null)},u=function(){l(!0),n(!0)};return Object(r.useEffect)((function(){return ft=window.setTimeout(u,5e3),function(){s()}}),[]),{active:a,handleLoaded:function(){s(),a&&n(!1)},turnToInactive:function(){a&&n(!1)},isMount:c,unMount:function(){c&&l(!1)}}}(),o=n.active,c=n.handleLoaded,l=n.turnToInactive,s=n.isMount,u=n.unMount;return Object(r.useEffect)((function(){t&&c()}),[t,c]),s?i.a.createElement(pt.a,{in:o,timeout:500,onExited:u},i.a.createElement(_.a,{elevation:0,className:a.root},i.a.createElement("div",{className:a.text},i.a.createElement("p",null,"The backend of this application falls asleep again, usually he will wake up in half minute ",i.a.createElement("span",{className:a.noWrap},"\u0669(\u02ca\u3007\u02cb*)\u0648")),i.a.createElement("p",null,i.a.createElement("span",null,"Wanna check out "),i.a.createElement("a",{href:"https://www.xiaoxihome.com/",target:"_blank",rel:"noopener noreferrer",className:a.link},"XiaoxiHome"),i.a.createElement("span",null," while waiting?"))),i.a.createElement(Ge.a,{"aria-label":"close",name:"close",title:"close",onClick:l,className:a.button},i.a.createElement(dt.a,null)))):null},bt=a(309),vt=a(298);var Et=function(){return new URLSearchParams(Object(P.h)().search)},xt=Object(D.a)((function(e){return{paper:{width:"100%",padding:e.spacing(2,0)},root:{"& .Mui-selected":{backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText},"& .MuiPaginationItem-rounded:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.secondary.contrastText}}}})),jt=function(e){var t=e.count,a=e.page,n=xt(),r=Et();return t>1?i.a.createElement(_.a,{className:n.paper,elevation:0},i.a.createElement(bt.a,{count:t,page:a,shape:"rounded",className:n.root,renderItem:function(e){return r.set("page",e.page.toString()),i.a.createElement(vt.a,Object.assign({component:T.b,to:"/?"+r.toString()},e))}})):i.a.createElement(i.a.Fragment,null)},Ot=Object(D.a)((function(e){return{inheritColor:{color:e.palette.primary.contrastText},chipRoot:{borderRadius:5,backgroundColor:e.palette.primary.light,transitions:e.transitions.create("background-color"),"&:hover":{backgroundColor:e.palette.primary.main},"&:focus":{backgroundColor:e.palette.primary.main}},chipLabel:{padding:"2px 20px",fontSize:e.typography.body2.fontSize,fontWeight:700}}})),yt=function(e){var t=e.text,a=Ot(),n=Object(P.g)();return i.a.createElement(U.a,{className:a.inheritColor},i.a.createElement(rt.a,{label:t.toUpperCase(),onDelete:function(){n.push("/")},color:"primary",classes:{deletable:a.chipRoot,label:a.chipLabel}}))},wt=Object(D.a)((function(e){return{root:{width:"100%"},tags:{padding:e.spacing(2,2),margin:e.spacing(1,0),width:"100%"}}})),kt=function(e){var t,a=e.isLogin,n=e.tag,r=e.page,o=wt(),c=ze({tag:n,page:r}),l=Object(R.a)(c,3),s=l[0],u=l[1],m=l[2],d=null!==m;return s||!d?t=new Array(10).fill(0).map((function(e,t){return i.a.createElement(U.a,{width:"100%",my:1,borderRadius:"5px",key:t,overflow:"hidden"},i.a.createElement(Fe.a,{variant:"rect",animation:"wave",width:"100%",height:150}))})):u?t=i.a.createElement(F.a,{variant:"body1",component:"h2"},i.a.createElement(U.a,{fontWeight:700,color:"primary.main",textAlign:"center"},"Server is unavailable now, please try again later")):m&&(t=i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(_.a,{className:o.tags,elevation:0},i.a.createElement(yt,{text:n})),m.posts.map((function(e,t){return i.a.createElement(st,{key:t,isLogin:a,data:e})})),i.a.createElement(jt,{count:(null===m||void 0===m?void 0:m.total_pages)||1,page:(null===m||void 0===m?void 0:m.current_page)||1}))),i.a.createElement("div",{className:o.root},i.a.createElement(ht,{isLoaded:d}),t)};var St=Object(l.b)((function(e){return{isLogin:e.loginStatus.isLogin}}))(kt),Ct=Object(D.a)((function(e){return{button:{backgroundColor:e.palette.primary.light,maxWidth:"100%",color:"#fff",fontWeight:700,textTransform:"capitalize",letterSpacing:"inherit",borderBottom:"2px solid rgba(0,0,0,0.1)",borderRadius:"5px",padding:"4px 10px","& span":{color:"#fff"},"&:hover":{backgroundColor:e.palette.secondary.main}}}})),Nt=function(e){var t=e.width,a=e.text,n=e.onClick,r=e.disabled,o=Ct();return i.a.createElement(G.a,{variant:"contained",classes:{root:o.button},disableElevation:!0,onClick:n,style:{width:t},disabled:r},a)},It=function(e){var t=e.width,a=e.text,n=e.link,r=Ct();return i.a.createElement(G.a,{variant:"contained",classes:{root:r.button},disableElevation:!0,component:T.b,to:n,style:{width:t}},a)},Lt=a(154),Tt=a.n(Lt),Pt=Object(D.a)((function(e){return{root:Object(L.a)({width:"calc(100% - 16px)",margin:e.spacing(1),overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},e.breakpoints.down("md"),{width:"100%",margin:e.spacing(1,0)}),main:{width:"80%",minHeight:"100px",padding:e.spacing(2,0),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},title:{padding:e.spacing(.25,1),fontWeight:700,textTransform:"uppercase",fontSize:e.typography.caption.fontSize,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText,width:"100%",borderRadius:e.shape.borderRadius},titleText:{padding:e.spacing(0,1)}}})),Dt=function(e){var t=e.children,a=e.isLoading,n=e.title,r=e.error,o=Pt();return i.a.createElement(_.a,{className:o.root,elevation:0},n&&i.a.createElement("div",{className:o.title},n),i.a.createElement("div",{className:o.main},a&&i.a.createElement(ce.a,{color:"primary",size:25}),r&&i.a.createElement(Tt.a,{color:"disabled"}),!a&&!r&&t))},Rt=Object(D.a)((function(e){return{rowWrapper:{width:"100%",margin:"8px 0"}}})),_t=function(e){var t=e.isLogin,a=Rt();return i.a.createElement(Dt,null,i.a.createElement("div",{className:a.rowWrapper},i.a.createElement(It,{link:"/edit-post",width:"100%",text:"Create Post"})),t&&i.a.createElement("div",{className:a.rowWrapper},i.a.createElement(It,{link:"/account-setting",width:"100%",text:"Account Settings"})))},Mt=function(e,t){var a=Object(r.useRef)(!1);Object(r.useEffect)((function(){a.current||t&&(e(),a.current=!0)}),[e,t])},Wt=a(99),At=a.n(Wt),zt=function(){var e=Object(r.useRef)(At.a.CancelToken),t=Object(r.useRef)([]),a=Object(r.useMemo)((function(){return function(){var a=e.current.source();return t.current.push(a),a.token}}),[]);return Object(r.useEffect)((function(){return function(){t.current.forEach((function(e){return e.cancel("component will unmount")}))}}),[]),a},Ft=function(e,t){var a=Me(),n=a.loading,r=a.setLoading,i=a.errorMessage,o=a.setErrorMessage,c=a.data,l=a.setData,s=a.error,u=a.resetError;Mt(d,t);var m=zt();function d(){return p.apply(this,arguments)}function p(){return(p=Object(Te.a)(Le.a.mark((function t(){var a,i;return Le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n){t.next=3;break}return t.abrupt("return");case 3:return u(),r(!0),t.next=7,At.a.get(e,{cancelToken:m()});case 7:return a=t.sent,t.next=10,a.data;case 10:"success"===(i=t.sent).status?l(i.data):"error"===i.status?o(i.message||Pe):o(Pe),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),o(Pe);case 17:return t.prev=17,r(!1),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,14,17,20]])})))).apply(this,arguments)}return{loading:n,error:s,errorMessage:i,data:c,doGet:d}},Ut=function(){var e=Ft(ne.tagList,!0);return[e.loading,e.error,e.data]},Bt=function(e){var t,a=e.text,n=e.to,r=e.number,o=e.barPercentage,c=(t=o,Object(D.a)((function(e){return{root:{margin:0,width:"100%",padding:2,borderRadius:2,height:"auto",backgroundColor:Object(nt.fade)(e.palette.primary.light,0),transitions:e.transitions.create(["background-color"]),color:e.palette.text.primary,justifyContent:"flex-start",position:"relative","&:hover $barItem":{height:"100%",width:"100%",transition:e.transitions.create(["height","width"])}},label:{width:"100%",fontSize:e.typography.caption.fontSize,fontWeight:700,textTransform:"capitalize",padding:"2px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},text:{flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},number:{textAlign:"end",paddingLeft:"4px"},barWrapper:{position:"absolute",bottom:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"flex-start",borderRadius:e.shape.borderRadius},barItem:{backgroundColor:Object(nt.fade)(e.palette.secondary.light,.5),height:"50%",width:t,borderRadius:e.shape.borderRadius,transition:e.transitions.create(["height","width"])}}})))();return i.a.createElement(G.a,{component:T.b,to:n,classes:{root:c.root,label:c.label}},i.a.createElement("div",{className:c.text,style:{zIndex:2}},a),i.a.createElement("div",{className:c.number,style:{zIndex:2}},r),i.a.createElement("div",{className:c.barWrapper,style:{zIndex:1}},i.a.createElement("div",{className:c.barItem})))},Ht=Object(D.a)((function(e){return{root:{width:"100%",position:"relative"}}})),Gt=function(e){var t=e.items,a=Ht(),n=Object(r.useMemo)((function(){var e=t.reduce((function(e,t){return Math.max(e,t.number)}),0);return t.map((function(t){return"".concat((t.number/e*100).toFixed(2),"%")}))}),[t]);return i.a.createElement("div",{className:a.root},t.map((function(e,t){return i.a.createElement(Bt,{key:e.text,text:e.text,to:e.to,number:e.number,barPercentage:n[t]})})))},Kt=a(72),Vt=new function e(){var t=this;Object(Kt.a)(this,e),this.home="/",this.login="/login",this.register="/register",this.postDetail="/post/:postID",this.editPost="/edit-post/:postID?",this.accountSetting="/account-setting",this.fallback="/*",this.getPostList=function(e){var a=t.home,n=Object.entries(e);n.length>0&&(a+="?",a+=n.map((function(e){return"".concat(e[0],"=").concat(e[1])})).join("&"));return a},this.getPostDetail=function(e){return"/post/".concat(e)},this.getEditPost=function(e){return"/edit-post/".concat(e)}},Jt=Object(D.a)((function(e){return{}})),Xt=function(){Jt();var e=Ut(),t=Object(R.a)(e,3),a=t[0],n=t[1],o=t[2],c=Object(r.useMemo)((function(){return null===o||void 0===o?void 0:o.map((function(e){return{text:e.tag.toLowerCase(),to:Vt.getPostList({tag:e.tag}),number:e.count}})).sort((function(e,t){return-e.number+t.number}))}),[o]);return i.a.createElement(Dt,{isLoading:a,title:"tags",error:n},c&&i.a.createElement(Gt,{items:c}))},$t=function(){var e=ne.popularPosts,t=Ft(e,!0);return[t.loading,t.error,t.data]},qt=Object(D.a)((function(e){return{}})),Yt=function(){qt();var e=$t(),t=Object(R.a)(e,3),a=t[0],n=t[1],o=t[2],c=Object(r.useMemo)((function(){return null===o||void 0===o?void 0:o.posts.map((function(e){return{text:e.title,to:Vt.getPostDetail(e.id),number:e.view_count}}))}),[o]);return i.a.createElement(Dt,{isLoading:a,title:"popular posts",error:n},c&&i.a.createElement(Gt,{items:c}))},Qt=Object(D.a)((function(e){return{}})),Zt=function(e){var t=e.isLogin;Qt();return i.a.createElement(i.a.Fragment,null,i.a.createElement(_t,{isLogin:t}),i.a.createElement(Xt,null),i.a.createElement(Yt,null))};var ea=Object(l.b)((function(e){return{isLogin:e.loginStatus.isLogin}}))(Zt),ta=Object(D.a)((function(e){return{root:Object(L.a)({margin:e.spacing(2,0),width:"100%",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",flexWrap:"wrap"},e.breakpoints.down("md"),{flexDirection:"column",margin:0}),left:Object(L.a)({width:"75%"},e.breakpoints.down("md"),{width:"100%"}),right:Object(L.a)({width:"25%"},e.breakpoints.down("md"),{width:"100%"})}})),aa=function(){var e=ta(),t=Et(),a=t.get("tag"),n=t.get("page")||"1";return i.a.createElement("div",{className:e.root},i.a.createElement("div",{className:e.left},i.a.createElement(St,{tag:a,page:n,key:"tag=".concat(a,"&page=").concat(n)})),i.a.createElement("div",{className:e.right},i.a.createElement(ea,null)))},na=a(290),ra=a(305),ia=a(291),oa=ye()((function(e){return Object(na.a)({root:{},content:{backgroundColor:e.palette.primary.main}})})),ca=function(e){var t=e.open,a=e.closeSnackbar,n=e.message,r=oa();return i.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,autoHideDuration:5e3,onClose:a,className:r.root},i.a.createElement(ia.a,{className:r.content,message:i.a.createElement(F.a,{variant:"body1",component:"div"},i.a.createElement(U.a,{fontWeight:700},n)),action:[i.a.createElement(Ge.a,{key:"close","aria-label":"close",color:"inherit",onClick:a},i.a.createElement(dt.a,null))]}))};var la=Object(l.b)((function(e){return{open:e.snackbar.open,message:e.snackbar.message}}),(function(e){return{closeSnackbar:function(){return e({type:f.CLOSE_SNACKBAR})}}}))(ca),sa=Object(D.a)((function(e){return{root:{listStyleType:"none",margin:0,padding:0},header:{fontSize:"1.25rem",margin:"8px 0",letterSpacing:"0",fontWeight:700},content:{fontSize:"0.875rem",padding:"2px","&:hover":{color:e.palette.secondary.main}}}})),ua=function(e){var t=e.data,a=sa();return i.a.createElement("ul",{className:a.root},t.map((function(e,t){return 0===t?i.a.createElement("li",{key:t},i.a.createElement("div",{className:a.header},e.title)):i.a.createElement("li",{key:t},i.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},i.a.createElement("div",{className:a.content},e.title)))})))},ma=[{title:"Learn More",url:""},{title:"API Endpoints",url:"https://www.google.ca/"},{title:"GitHub",url:"https://github.com/CptDoraemon/discussion-board-client"},{title:"XiaoxiHome",url:"https://www.xiaoxihome.com/"}],da=Object(D.a)((function(e){return{root:{width:"100%",margin:"40px 0 8px 0"},paper:{width:"100%",backgroundColor:"#4a5568",color:"#a0aec0",padding:e.spacing(5)},copyright:{width:"100%",margin:e.spacing(5,0,0,0),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontSize:"0.8rem"}}})),pa=function(){var e=da();return i.a.createElement("footer",{className:e.root},i.a.createElement(_.a,{className:e.paper},i.a.createElement(z.a,{container:!0,spacing:5},i.a.createElement(z.a,{item:!0},i.a.createElement(ke,null)),i.a.createElement(z.a,{item:!0},i.a.createElement(ua,{data:ma}))),i.a.createElement("div",{className:e.copyright},i.a.createElement("div",null,"\xa9 XiaoxiHome.com"),i.a.createElement("div",null,"Since 2020"))))},fa=a(163),ga=function(e){var t=e.children,a=e.isLogin,n=Object(fa.a)(e,["children","isLogin"]);return i.a.createElement(P.b,Object.assign({},n,{render:function(e){var n=e.location;return a?t:i.a.createElement(P.a,{to:{pathname:"/login",state:{from:n}}})}}))},ha=(a(225),a(242)),ba=a(247),va=a(240),Ea=a(243),xa=function(e,t){return t.filter((function(t){return-1!==e.indexOf(t)}))},ja=function(e,t,a,n){return new Promise((function(r,i){var o=new FormData;o.append("title",e),o.append("tag",t);var c=n.map((function(e){return Oa(e)}));Promise.all(c).then((function(e){e.forEach((function(e,t){var n=e.name.split("/"),r=0===n[n.length-1].length?n[n.length-2]:n[n.length-1];a=a.replace(e.name,r),o.append("file".concat(t),e.blob,e.name+".jpg")})),o.append("content",a),r(o)}))}))},Oa=function(e){return new Promise((function(t,a){fetch(e).then((function(e){return e.blob()})).then((function(a){return t({blob:a,name:e})})).catch((function(e){return a(e)}))}))},ya=function(){var e=Object(r.useState)(!1),t=Object(R.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)(!1),o=Object(R.a)(i,2),c=o[0],l=o[1],s=Object(r.useState)(""),u=Object(R.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(!1),f=Object(R.a)(p,2),g=f[0],h=f[1],b=_e();return[a,c,m,function(){var e=Object(Te.a)(Le.a.mark((function e(t,r,i,o,c){var s,u,m,p;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!a&&!g){e.next=3;break}return e.abrupt("return");case 3:return l(!1),d(" "),n(!0),o=xa(i,o),e.next=9,ja(t,r,i,o);case 9:return s=e.sent,u=void 0===c?ne.createPost:ne.editPost(c),e.next=13,b(!0,u,{method:"POST",body:s});case 13:return m=e.sent,e.next=16,m.json();case 16:p=e.sent,n(!1),"success"===p.status?h(!0):(d(p.message),l(!0)),e.next=27;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0),n(!1),d("Server is not available please try again later"),l(!0);case 27:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,a,n,r,i){return e.apply(this,arguments)}}(),g]},wa=a(101),ka=a.n(wa),Sa=a(100),Ca=a.n(Sa),Na=function(e,t){var a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("accept","image/*"),a.click(),a.onchange=function(){if(a.files){var n=a.files[0];Ca()(n,(function(a){a.toBlob((function(a){var n=URL.createObjectURL(a),r=e.getSelection(),i=r?r.index:0;e.insertEmbed(i,"image","".concat(n)),e.setSelection(i+1,0,"api"),t.push(n)}),"image/jpeg")}),{orientation:!0,canvas:!0})}}},Ia=function(e){var t=Object(r.useState)(null),a=Object(R.a)(t,2),n=a[0],i=a[1],o=Object(r.useRef)([]);return Object(r.useEffect)((function(){var t=ka.a.import("formats/image"),a=ka.a.import("formats/link");t.sanitize=function(e){return a.sanitize(e,["http","https","data"])?e:"//:0"};var n=new ka.a("#".concat(e),{modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"],["link","image","code-block"]],clipboard:{matchVisual:!1}},placeholder:"Compose an epic...",theme:"snow"});n.getModule("toolbar").addHandler("image",(function(){return Na(n,o.current)})),i(n)}),[e]),[n,function(){return o.current},function(e){if(n){var t=n.clipboard.convert(e);n.setContents(t)}}]};var La=function(e){Object(r.useEffect)((function(){return document.title=e||"Blog | XiaoxiHome",function(){document.title="Blog | XiaoxiHome"}}),[e])},Ta=function(){var e=We("",!1),t=e.loading,a=e.error,n=e.data,r=e.doGet;La(null===n||void 0===n?void 0:n.title);return[t,a,n,function(e){r(ne.getPostDetail(e),!1)}]},Pa=a(245),Da=a(306),Ra=Object(D.a)((function(e){return{root:{textTransform:"capitalize",backgroundColor:Object(nt.fade)(e.palette.primary.main,.8),color:e.palette.primary.contrastText,borderRadius:5,padding:"5px 15px","&:focus":{backgroundColor:Object(nt.fade)(e.palette.primary.main,.8),color:e.palette.primary.contrastText,borderRadius:5}},icon:{color:e.palette.primary.contrastText},menuItemRoot:{textTransform:"capitalize","&:hover":{backgroundColor:e.palette.primary.main},"&:focus":{backgroundColor:e.palette.primary.main}},menuRoot:{backgroundColor:e.palette.primary.light,color:e.palette.primary.contrastText,borderRadius:5}}})),_a=function(e){var t=e.tagList,a=e.tagValue,n=e.tagChangeHandler,r=Ra();return i.a.createElement(Pa.a,{value:a,onChange:n,displayEmpty:!0,disableUnderline:!0,classes:{root:r.root,icon:r.icon},MenuProps:{classes:{paper:r.menuRoot}}},t.map((function(e){var t=e.tag;return i.a.createElement(Da.a,{value:t,key:t,classes:{root:r.menuItemRoot}},t.toLowerCase())})))},Ma=a(308),Wa=Object(D.a)((function(e){return{root:{width:"100%",padding:e.spacing(2)},editor:{width:"100%",minHeight:"300px",marginBottom:"16px"},title:{width:"100%"}}})),Aa=function(e){var t=e.updatePost,a=e.tagList,n=Wa(),o=void 0===t?"":t.title,c=void 0===t?a[0].tag:t.tag,l=Ia("editor"),s=Object(R.a)(l,3),u=s[0],m=s[1],d=s[2],p=J(o,Q),f=Object(R.a)(p,5),g=f[0],h=f[1],b=f[2],v=f[3],E=f[4],x=Object(r.useState)(c),j=Object(R.a)(x,2),O=j[0],y=j[1],w=ya(),k=Object(R.a)(w,5),S=k[0],C=k[1],N=k[2],I=k[3],L=k[4],T=Object(r.useRef)(!1);Object(r.useEffect)((function(){u&&void 0!==t&&(T.current||(d(t.content),T.current=!0))}),[u,d,t]);return i.a.createElement("form",null,i.a.createElement(ha.a,{className:n.title},i.a.createElement(ba.a,{htmlFor:"post-editor-title"},"Title"),i.a.createElement(va.a,{id:"post-editor-title","aria-describedby":"post-editor-title-helper-text",value:g,onChange:h}),i.a.createElement(Ea.a,{id:"post-editor-title-helper-text",error:b},b&&v?v:" ")),i.a.createElement(U.a,{mb:2},"Tag: ",i.a.createElement(_a,{tagList:a,tagValue:O,tagChangeHandler:function(e){y(e.target.value)}})),i.a.createElement("div",{id:"editor",className:n.editor}),i.a.createElement(Nt,{onClick:function(e){e.preventDefault(),E()&&u&&(void 0===t?I(g,O,u.root.innerHTML,m()):I(g,O,u.root.innerHTML,m(),t.postID))},width:"250px",text:L?"Submitted":"Submit",disabled:L||S}),i.a.createElement(U.a,{mt:1},i.a.createElement(se,{loading:S,error:C,errorMessage:N,spinnerSize:25})))},za=function(){var e=Wa(),t=Object(P.i)().postID,a=Object(r.useState)(!0),n=Object(R.a)(a,2),o=n[0],c=n[1],l=Ta(),s=Object(R.a)(l,4),u=(s[0],s[1]),m=s[2],d=s[3],p=Ut(),f=Object(R.a)(p,3),g=(f[0],f[1]),h=f[2];Object(Ma.a)((function(){void 0===t?c(!1):d(parseInt(t))}));var b=(!o||null!==m)&&null!==h;return i.a.createElement(_.a,{className:e.root,elevation:0},!b&&i.a.createElement(U.a,{width:"100%",height:500,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},u||g?"Cannot retrieve post data at the moment":i.a.createElement(ce.a,{color:"primary"})),!o&&b&&i.a.createElement(Aa,{tagList:h||[]}),null!==m&&b&&i.a.createElement(Aa,{tagList:h||[],updatePost:{title:m.title,content:m.content,postID:parseInt(m.id),tag:m.tag}}))},Fa=function(){var e=Object(P.g)(),t=Object(P.h)();return function(){e.replace("/"),e.replace(t)}},Ua=function(){var e=Fa(),t=Ze(),a=t.loading,n=t.error,r=t.errorMessage,i=t.doPost;return[a,n,r,function(t,a,n){var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t,parent_post:a,parent_comment:n})};i(ne.createComment,r,!0,e)}]},Ba=Object(D.a)((function(e){return{root:{width:"100%",margin:"16px 0"},input:{width:"100%"}}})),Ha=function(e){var t=e.parentPost,a=e.parentComment,n=Ba(),r=J("",Z),o=Object(R.a)(r,5),c=o[0],l=o[1],s=o[2],u=o[3],m=o[4],d=Ua(),p=Object(R.a)(d,4),f=p[0],g=p[1],h=p[2],b=p[3];return i.a.createElement("form",{className:n.root},i.a.createElement(B.a,{id:"comment-input",label:"Leave comment",name:"comment",value:c,onChange:l,error:s,helperText:s&&u?u:" ",variant:"outlined",className:n.input}),i.a.createElement(Nt,{onClick:function(e){e.preventDefault(),m()&&b(c,t,a)},width:"250px",text:"Submit",disabled:f}),g&&h&&i.a.createElement(se,{loading:f,error:g,errorMessage:h}))},Ga=a(156),Ka=a.n(Ga),Va=a(300),Ja=Object(D.a)((function(e){return{postInfo:Object(L.a)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",color:e.palette.grey[500],fontWeight:700},e.breakpoints.down("md"),{flexDirection:"column",alignItems:"flex-start",justifyContent:"center"}),avatar:{backgroundColor:e.palette.primary.main},avatarSmall:{width:"1.2rem",height:"1.2rem",fontSize:"0.8rem"},username:{color:e.palette.text.primary},postInfoItem:Object(L.a)({margin:e.spacing(0,2)},e.breakpoints.down("md"),{margin:"4px 0"}),iconTextItem:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",color:e.palette.grey[400],"& p":{margin:e.spacing(0,1),color:e.palette.grey[500]}}}})),Xa=function(e){var t=e.type,a=e.isLogin,n=e.username,r=e.avatarUrl,o=e.created,c=e.id,l=e.likes,s=e.dislikes,u=e.isLiked,m=e.small,d=e.viewCount,p=Ja(),f=a?u:void 0;return i.a.createElement("div",{className:p.postInfo},i.a.createElement("div",{className:p.postInfoItem},i.a.createElement(Ue.a,{variant:"rounded",className:m?"".concat(p.avatar," ").concat(p.avatarSmall):p.avatar,src:r},n.charAt(0))),i.a.createElement("div",{className:"".concat(p.postInfoItem," ").concat(p.username)},n),i.a.createElement("div",{className:p.postInfoItem},He(o)),i.a.createElement("div",{className:p.postInfoItem},i.a.createElement(at,{type:t,id:c,likes:l,dislikes:s,isLiked:f})),void 0!==d&&i.a.createElement("div",{className:p.postInfoItem},i.a.createElement(Va.a,{title:"Page View","aria-label":"Page View"},i.a.createElement("div",{className:p.iconTextItem},i.a.createElement(Ka.a,null),i.a.createElement("p",null,d)))))},$a=a(157),qa=a.n($a),Ya=Object(D.a)((function(e){return{root:{width:"100%"},content:{margin:"32px"}}})),Qa=function(e){var t=e.isLogin,a=e.data,n=Ya();return i.a.createElement("div",{className:n.root},i.a.createElement(Xa,{type:"comment",isLogin:t,username:a.owner.username,avatarUrl:a.owner.avatar_url,created:a.created,id:a.id,likes:a.likes,dislikes:a.dislikes,isLiked:a.is_liked,small:!0}),i.a.createElement("div",{className:n.content},a.content))},Za=Object(D.a)((function(e){return{root:{margin:"20px 0",width:"100%",padding:e.spacing(2)},content:{margin:"32px"},commentButton:{margin:"0 32px",color:e.palette.grey[500]},subCommentPanel:{width:"calc(100% - 32px)",margin:"8px 0 8px 32px",border:"1px solid ".concat(e.palette.grey[400]),borderRadius:"5px",padding:e.spacing(2)}}})),en=function(e){var t=e.data,a=e.postID,n=e.isLogin,o=Za(),c=Object(r.useState)(!1),l=Object(R.a)(c,2),s=l[0],u=l[1];return i.a.createElement(_.a,{className:o.root,elevation:0},i.a.createElement(Xa,{type:"comment",isLogin:n,username:t.owner.username,avatarUrl:t.owner.avatar_url,created:t.created,id:t.id,likes:t.likes,dislikes:t.dislikes,isLiked:t.is_liked,small:!0}),i.a.createElement("div",{className:o.content},t.content),i.a.createElement(G.a,{variant:"outlined",className:o.commentButton,disableElevation:!0,startIcon:i.a.createElement(qa.a,null),onClick:function(){return u((function(e){return!e}))},size:"small"},t.sub_comments.length),s&&i.a.createElement(pt.a,{in:s,timeout:1e3},i.a.createElement("div",{className:o.subCommentPanel},!t.sub_comments.length&&i.a.createElement(U.a,{textAlign:"center"},"No comment yet"),t.sub_comments.map((function(e,t){return i.a.createElement(Qa,{isLogin:n,data:e,key:t})})),n&&i.a.createElement(Ha,{parentPost:a,parentComment:t.id}))))},tn=Object(D.a)((function(e){return{link:{"&:link":{color:e.palette.primary.main},"&:visited":{color:e.palette.primary.main},"&:hover":{color:e.palette.secondary.main}}}})),an=function(e){var t=e.text,a=e.to,n=e.fromState,r=tn(),o=Object(P.h)(),c=n?{pathname:a,state:{from:o.pathname}}:a;return i.a.createElement(T.b,{to:c,className:r.link},t)},nn=Object(D.a)((function(e){return{root:{margin:"60px 0",width:"100%"},paper:{width:"100%",padding:e.spacing(4)},loginToLeaveMessage:{width:"100%",height:"200px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",fontWeight:700,color:e.palette.grey[600]}}})),rn=function(e){var t=e.isLogin,a=e.comments,n=e.postID,r=e.data,o=nn();return i.a.createElement("div",{className:o.root},i.a.createElement(_.a,{className:o.paper,elevation:0},i.a.createElement(F.a,{variant:"body1",component:"div"},i.a.createElement(U.a,{fontWeight:700},"".concat(a," ").concat(a>1?"comments":"comment"))),i.a.createElement(H.a,null)),r.map((function(e,a){return i.a.createElement(en,{data:e,postID:n,key:a,isLogin:t})})),i.a.createElement(_.a,{className:o.paper,elevation:0},t?i.a.createElement(Ha,{parentPost:n,parentComment:null}):i.a.createElement("div",{className:o.loginToLeaveMessage},i.a.createElement("span",null,i.a.createElement(an,{text:"Login",to:"/login",fromState:!0})," to leave a comment"))))},on=Object(D.a)((function(e){return{root:{display:"column",flexDirection:"row",alignItems:"center",justifyContent:"center",color:e.palette.text.primary,whiteSpace:"normal",overflowWrap:"break-word","& pre":{whiteSpace:"pre-wrap",wordWrap:"break-word"},"& a":{wordWrap:"break-word",background:"linear-gradient(to bottom, ".concat(e.palette.primary.light," 0%, ").concat(e.palette.primary.light," 100%)"),backgroundPosition:"0 100%",backgroundRepeat:"repeat-x",backgroundSize:"4px 4px",transition:e.transitions.create(["background-size","color"])},"& a:hover":{backgroundSize:"4px 100%",color:e.palette.primary.contrastText},"& img":{maxWidth:"100%",maxHeight:"600px",display:"block",margin:"4px auto"},"& p":{}}}})),cn=a(158),ln=a.n(cn),sn=function(){var e=Object(l.c)(),t=Object(P.g)(),a=Ze(),n=a.loading,r=a.error,i=a.doPost;return[n,r,function(){var a=Object(Te.a)(Le.a.mark((function a(n){var r,o,c,l;return Le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r={method:"POST",headers:{"Content-Type":"application/json"}},o=function(){t.replace("/"),e(v("Post deleted"))},c=function(t){e(v(t||Pe))},l=function(){e(v(Pe))},i(ne.deletePost(n),r,!0,o,c,l);case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()]},un=a(307),mn=a(292),dn=a(293),pn=a(294),fn=a(295),gn=Object(D.a)((function(e){return{button:{color:e.palette.warning.light,fontSize:"1.25rem","&:hover":{color:e.palette.warning.main},"&:focus":{color:e.palette.warning.main}},confirmButton:{color:e.palette.warning.main}}})),hn=function(e){var t=e.id,a=gn(),n=sn(),o=Object(R.a)(n,3),c=o[0],l=(o[1],o[2]),s=Object(r.useState)(!1),u=Object(R.a)(s,2),m=u[0],d=u[1],p=function(){d(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(Va.a,{title:"Delete","aria-label":"delete"},i.a.createElement(Ge.a,{"aria-label":"delete",className:a.button,disabled:c,onClick:function(){d(!0)}},i.a.createElement(ln.a,null))),i.a.createElement(un.a,{open:m,onClose:p,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(mn.a,{id:"alert-dialog-title"},"Are you sure to delete this post?"),i.a.createElement(dn.a,null,i.a.createElement(pn.a,{id:"alert-dialog-description"},"It will not be possible to recover this post once deleted.")),i.a.createElement(fn.a,null,i.a.createElement(G.a,{onClick:p,color:"primary"},"Forget it"),i.a.createElement(G.a,{onClick:function(){l(t)},autoFocus:!0,disabled:c,className:a.confirmButton},"I'm sure"))))},bn=a(159),vn=a.n(bn),En=Object(D.a)((function(e){return{textColor:{color:e.palette.success.light},button:{fontSize:"1.25rem","&:hover":{color:e.palette.success.main},"&:focus":{color:e.palette.success.main}}}})),xn=function(e){var t=e.id,a=En();return i.a.createElement(Va.a,{title:"Edit","aria-label":"edit"},i.a.createElement(U.a,{className:a.textColor},i.a.createElement(Ge.a,{"aria-label":"edit",component:T.b,to:"/edit-post/".concat(t),classes:{root:a.button}},i.a.createElement(vn.a,null))))},jn=Object(D.a)((function(e){return{root:{width:"100%",margin:e.spacing(1,0,0,0)},paper:{width:"100%",padding:e.spacing(4)},loading:{width:"100%",height:"500px"},center:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}}})),On=function(e){var t,a=e.isLogin,n=jn(),o=on(),c=Object(r.useRef)(null),l=Object(P.i)().postID,s=Ta(),u=Object(R.a)(s,4),m=u[0],d=u[1],p=u[2],f=u[3];return Object(Ma.a)((function(){f(parseInt(l||"1"))})),m?t=i.a.createElement("div",{className:n.loading},i.a.createElement(Fe.a,{variant:"rect",width:"100%",height:"100%"})):d?t=i.a.createElement(U.a,{className:n.center,height:500},i.a.createElement("h1",null,"Server error")):p&&(t=i.a.createElement(i.a.Fragment,null,i.a.createElement(_.a,{className:n.paper,elevation:0},i.a.createElement(U.a,{width:"100%"},i.a.createElement(ct,{text:p.tag,size:"normal"})),i.a.createElement("h1",null," ",p.title," "),i.a.createElement(Xa,{type:"post",isLogin:a,username:p.owner.username,avatarUrl:p.owner.avatar_url,created:p.created,id:p.id,likes:p.likes,dislikes:p.dislikes,isLiked:p.is_liked,viewCount:p.view_count}),i.a.createElement(U.a,{className:n.center,my:2},a&&p.is_owner&&i.a.createElement(i.a.Fragment,null,i.a.createElement(hn,{id:parseInt(p.id)}),i.a.createElement(xn,{id:parseInt(p.id)}))),i.a.createElement(U.a,{width:"100%",height:"40px"}," "),i.a.createElement("div",{dangerouslySetInnerHTML:{__html:p.content},className:o.root,ref:c})),i.a.createElement(rn,{comments:p.comments,isLogin:a,postID:p.id,data:p.comments_data}))),i.a.createElement("div",{className:n.root},t)},yn=Object(D.a)((function(e){return{root:{width:"100%",minHeight:"100px"},sectionTitle:{width:"100%",padding:e.spacing(1,2),backgroundColor:e.palette.primary.light,fontWeight:700,color:"#fff"},content:{width:"100%",padding:e.spacing(2)}}})),wn=function(e){var t=e.children,a=e.sectionTitle,n=yn();return i.a.createElement("div",{className:n.root},i.a.createElement(F.a,{variant:"body1",component:"h3"},i.a.createElement(U.a,{className:n.sectionTitle},a)),i.a.createElement("div",{className:n.content},t))},kn=a(160),Sn=a(161),Cn=a.n(Sn);a(234);var Nn,In=function(e,t,a,n){var r=[t.x,t.y,t.width,t.height].map((function(e){return void 0===e?1:e})),i=Object(R.a)(r,4),o=i[0],c=i[1],l=i[2],s=i[3],u=document.createElement("canvas");u.width=800,u.height=800;var m=u.getContext("2d");return m?new Promise(function(){var t=Object(Te.a)(Le.a.mark((function t(n,r){return Le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,m.drawImage(e,o*a,c*a,l*a,s*a,0,0,800,800),u.toBlob((function(e){e&&n(e)}),"image/jpeg",1),t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),t.t0;case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,a){return t.apply(this,arguments)}}()):null},Ln=function(){var e=_e(),t=Object(r.useState)(!1),a=Object(R.a)(t,2),n=a[0],i=a[1],o=Object(r.useState)(!1),c=Object(R.a)(o,2),l=c[0],s=c[1],u=Object(r.useState)(""),m=Object(R.a)(u,2),d=m[0],p=m[1];return[n,l,d,function(t){return new Promise((function(a,r){if(n)r();else{s(!1),p(""),i(!0);var o=new FormData;o.append("image",t,"avatar.jpg"),e(!0,ne.updateAvatar,{method:"POST",body:o}).then((function(e){return e.json()})).then((function(e){i(!1),console.log(e),"success"!==e.status?(s(!0),"error"===e.status?p(e.message):p("Server unavailable, please try again later."),r()):a(!0)})).catch((function(e){i(!1),s(!0),p("Server unavailable, please try again later."),r()}))}}))}]},Tn=function(e,t){var a=Object(r.useState)(0),n=Object(R.a)(a,2),i=n[0],o=n[1],c=Object(r.useState)(0),l=Object(R.a)(c,2),s=l[0],u=l[1],m=function(a){if(t&&e.current){var n=e.current.getBoundingClientRect().width,r=Pn(n,a.naturalWidth,a.naturalHeight),i=Object(R.a)(r,2),c=i[0],l=i[1];o(c),u(l)}};return Object(r.useEffect)((function(){!function(){var e=new Image;e.src=t,e.onload=function(){return m(e)}}()}),[e,t]),[i,s]},Pn=function(e,t,a){var n=Math.min(500,e)||1,r=1,i=1;return t>=a?i=(r=n)/t*a:r=(i=n)/a*t,[Math.min(t,Math.round(r)),Math.min(a,Math.round(i))]};!function(e){e.UPLOAD="UPLOAD",e.CROP="CROP",e.CONFIRM="CONFIRM",e.FINISH="FINISH"}(Nn||(Nn={}));var Dn=Object(D.a)((function(e){return{root:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},row:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},backNextButtons:{width:"100%",margin:e.spacing(1,0),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},centering:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})),Rn=function(e){var t=e.restart,a=Dn();return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:a.backNextButtons},i.a.createElement(Nt,{onClick:t,width:"150px",text:"Start Again"})),i.a.createElement("div",{className:"centering"},i.a.createElement(U.a,{fontWeight:700,my:2},"All set")))},_n=function(e){var t=e.blob,a=e.back,n=e.next,o=Dn(),c=Ln(),l=Object(R.a)(c,4),s=l[0],u=l[1],m=l[2],d=l[3],p=Object(r.useRef)(null),f=Object(r.useMemo)((function(){return URL.createObjectURL(t)}),[t]),g=Tn(p,f),h=Object(R.a)(g,2),b=h[0],v=h[1],E=function(){var e=Object(Te.a)(Le.a.mark((function e(){return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=6;break}return e.next=4,d(t);case 4:e.sent&&n();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:o.backNextButtons},i.a.createElement(U.a,null,i.a.createElement(Nt,{onClick:a,width:"150px",text:"Redo Cropping"})),i.a.createElement(U.a,null,i.a.createElement(Nt,{onClick:E,width:"150px",text:"Update Avatar",disabled:s}))),i.a.createElement(se,{loading:s,error:u,errorMessage:m}),!s&&i.a.createElement("div",{className:o.centering,ref:p},i.a.createElement("img",{src:f,alt:"cropped",style:{width:b,height:v}})))},Mn=function(e){var t=e.src,a=e.back,n=e.next,o=Dn(),c=Object(r.useState)(!1),l=Object(R.a)(c,2),s=l[0],u=l[1],m=Object(r.useState)(null),d=Object(R.a)(m,2),p=d[0],f=d[1],g=Object(r.useState)({}),h=Object(R.a)(g,2),b=h[0],v=h[1],E=Object(r.useRef)(null),x=Object(r.useState)({width:1,height:1}),j=Object(R.a)(x,2),O=j[0],y=j[1],w=function(){var e=Object(Te.a)(Le.a.mark((function e(){var t;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,In(p,b,p.naturalWidth/O.width," ");case 5:(t=e.sent)&&n(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){var e=O.width,t=O.height;if(e>=t){var a=Math.round((e-t)/2);v({aspect:1,unit:"px",height:t,width:t,x:a,y:0})}else{var n=Math.round((t-e)/2);v({aspect:1,unit:"px",height:e,width:e,x:0,y:n})}}),[O.width,O.height]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:o.backNextButtons},i.a.createElement(U.a,{justifySelf:"flex-start"},i.a.createElement(Nt,{onClick:a,width:"150px",text:"Repick"})),i.a.createElement(U.a,{justifySelf:"flex-end"},i.a.createElement(Nt,{onClick:w,width:"150px",text:"Crop"}))),i.a.createElement(se,{loading:!1,error:!1,errorMessage:""}),i.a.createElement("div",{ref:E,className:o.centering},i.a.createElement(Cn.a,{src:t,crop:b,onChange:function(e){return v(e)},ruleOfThirds:!0,onImageError:function(){return u(!0)},onImageLoaded:function(e){if(f(e),E.current){var t=Pn(E.current.getBoundingClientRect().width,e.naturalWidth,e.naturalHeight),a=Object(R.a)(t,2),n=a[0],r=a[1];y({width:n,height:r})}},style:{width:O.width,height:O.height}})),s&&i.a.createElement(se,{loading:!1,error:!0,errorMessage:"Image can't be loaded"}))},Wn=function(e){var t=e.next,a=Dn(),n=Object(r.useRef)(null),o=Object(r.useState)(""),c=Object(R.a)(o,2),l=(c[0],c[1],Object(r.useState)(!1)),s=Object(R.a)(l,2),u=s[0],m=s[1],d=function(){if(n.current&&n.current.files&&n.current.files.length){if(u)return;m(!0),Ca()(n.current.files[0],(function(e){t(e.toDataURL("image/jpeg"))}),{orientation:!0,canvas:!0})}};return Object(r.useEffect)((function(){var e=n.current;return null===e||void 0===e||e.addEventListener("change",d),function(){null===e||void 0===e||e.removeEventListener("change",d)}}),[]),i.a.createElement("div",{style:{width:"100%"}},i.a.createElement("div",{className:a.centering},i.a.createElement(U.a,{my:2},u?i.a.createElement(se,{loading:!0,error:!1,errorMessage:""}):i.a.createElement(U.a,null,i.a.createElement(Nt,{onClick:function(){var e;null===(e=n.current)||void 0===e||e.click()},width:"150px",text:"Upload From Disk",disabled:u}))),i.a.createElement("input",{type:"file",ref:n,accept:"image/*",style:{display:"none"}})))},An=function(e){Object(kn.a)(e);var t,a=Dn(),n=Object(r.useState)(Nn.UPLOAD),o=Object(R.a)(n,2),c=o[0],l=o[1],s=Object(r.useState)(""),u=Object(R.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(null),f=Object(R.a)(p,2),g=f[0],h=f[1],b=function(){l(Nn.UPLOAD)},v=function(e){d(e),l(Nn.CROP)};switch(c){case Nn.UPLOAD:t=i.a.createElement(Wn,{next:v});break;case Nn.CROP:t=i.a.createElement(Mn,{src:m,back:b,next:function(e){h(e),l(Nn.CONFIRM)}});break;case Nn.CONFIRM:t=i.a.createElement(_n,{blob:g,back:function(){l(Nn.CROP)},next:function(){l(Nn.FINISH)}});break;case Nn.FINISH:t=i.a.createElement(Rn,{restart:b});break;default:t=i.a.createElement(Wn,{next:v})}return i.a.createElement("div",{className:a.root},t)},zn=Object(D.a)((function(e){return{root:{margin:e.spacing(1,0),width:"100%"},paper:{width:"100%",minHeight:"100px",overflow:"hidden"}}})),Fn=function(e){var t=e.username,a=zn();return i.a.createElement("div",{className:a.root},i.a.createElement(F.a,{variant:"body1",component:"h2"},i.a.createElement(U.a,{my:2,fontWeight:700},t)),i.a.createElement(_.a,{className:a.paper,elevation:0},i.a.createElement(wn,{sectionTitle:"Avatar"},i.a.createElement(An,null))))};var Un=Object(l.b)((function(e){return{username:e.loginStatus.username}}))(Fn),Bn=a(115),Hn=["#ff4143","#50c5e3","#fcb415"],Gn=function(){function e(t,a){Object(Kt.a)(this,e),this.color=void 0,this.x=void 0,this.y=void 0,this.r=void 0,this.rotation=void 0,this.vx=void 0,this.vy=void 0,this.opacity=void 0,this.finished=void 0,this.params={dx:.92,dy:.95,g:.2,dr:.99,dOpacity:.015,dRotation:Math.random()+1,ddRotation:.95},this.color=function(){var e=Math.floor(Math.random()*Hn.length);return Hn[e]}(),this.x=.2*t,this.y=.4*a,this.r=5,this.rotation=Math.random()*Math.PI,this.vx=(-7*Math.random()+1)*(-t/90),this.vy=(2.5*Math.random()+1)*(-a/100),this.opacity=1,this.finished=!1}return Object(Bn.a)(e,[{key:"move",value:function(){if(this.vx=this.vx*this.params.dx,this.x=this.x+this.vx,this.vy=this.vy*this.params.dy,this.vy=this.vy+this.params.g,this.y=this.y+this.vy,this.vy>=0){var e=this.opacity-this.params.dOpacity;e>0?this.opacity=e:this.finished=!0}this.params.dRotation*=this.params.ddRotation,this.rotation+=this.params.dRotation}}]),e}(),Kn=function(){function e(t,a){Object(Kt.a)(this,e),this.params=void 0,this.ID=void 0,this.canvas=void 0,this.ctx=void 0,this.sprites=void 0,this.params=this.initParams(a),this.ID=t,this.canvas=null,this.ctx=null,this.sprites=[],this.loop=this.loop.bind(this)}return Object(Bn.a)(e,[{key:"initParams",value:function(e){var t={width:300,height:300,spritesCount:30};return void 0!==e?Object(De.a)(Object(De.a)({},t),e):t}},{key:"initCanvas",value:function(){this.canvas=document.getElementById(this.ID),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.params.width,this.canvas.height=this.params.height}},{key:"initSprites",value:function(){for(var e=0;e<this.params.spritesCount;e++)this.sprites.push(new Gn(this.params.width,this.params.height))}},{key:"initDrawer",value:function(){this.ctx&&(void 0===this.ctx.ellipse?this.drawer=function(e,t,a,n){e.arc(t,a,n,0,2*Math.PI)}:this.drawer=function(e,t,a,n,r){e.ellipse(t,a,n,1.2*n,r,0,2*Math.PI)})}},{key:"drawer",value:function(e,t,a,n,r){}},{key:"draw",value:function(){var e=this;this.ctx&&(this.ctx.clearRect(0,0,this.params.width,this.params.height),this.sprites.forEach((function(t){e.ctx&&(e.ctx.save(),e.ctx.beginPath(),e.drawer(e.ctx,t.x,t.y,t.r,t.rotation),e.ctx.fillStyle=t.color,e.ctx.globalAlpha=t.opacity,e.ctx.fill(),e.ctx.restore())})))}},{key:"update",value:function(){this.sprites=this.sprites.filter((function(e){return e.move(),!e.finished}))}},{key:"loop",value:function(){this.draw(),this.update(),this.sprites.length>0&&requestAnimationFrame(this.loop)}},{key:"main",value:function(){this.initCanvas(),this.initSprites(),this.initDrawer(),this.loop()}}]),e}(),Vn=function(){return Object(r.useEffect)((function(){new Kn("confetti-canvas").main()}),[]),i.a.createElement("canvas",{id:"confetti-canvas"})};var Jn=Object(D.a)((function(e){return{root:{width:"100%",maxWidth:"100vw",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},widthWrapper:Object(L.a)({margin:e.spacing(3,0,0,0),width:e.breakpoints.values.md,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},e.breakpoints.down("sm"),{width:"calc(100% - 16px)",margin:e.spacing(0,1)}),confetti:{position:"fixed",zIndex:e.zIndex.tooltip+1,bottom:"0",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}}));var Xn=Object(l.b)((function(e){return{isLogin:e.loginStatus.isLogin,confetti:e.confetti}}))((function(e){var t=e.isLogin,a=e.confetti,n=Jn();return function(){var e=Object(P.h)(),t=e.pathname,a=e.search,n=Object(Ae.a)(t),i=Object(Ae.a)(a);Object(r.useEffect)((function(){void 0!==i&&void 0!==n&&(i===a&&n===t||window.scrollTo(0,0))}),[t,n,i,a])}(),i.a.createElement("div",{className:n.root},i.a.createElement(T.a,{basename:"/discussion-board-client"},i.a.createElement(Ne,null),i.a.createElement("div",{className:n.widthWrapper},i.a.createElement(P.d,null,i.a.createElement(P.b,{path:Vt.home,exact:!0,render:function(){return i.a.createElement(aa,null)}}),i.a.createElement(P.b,{path:Vt.login,render:function(){return i.a.createElement(me,null)}}),i.a.createElement(P.b,{path:Vt.register,render:function(){return i.a.createElement(ge,null)}}),i.a.createElement(P.b,{path:Vt.postDetail,render:function(){return i.a.createElement(On,{isLogin:t})}}),i.a.createElement(ga,{path:Vt.editPost,isLogin:t},i.a.createElement(za,null)),i.a.createElement(ga,{path:Vt.accountSetting,isLogin:t},i.a.createElement(Un,null)),i.a.createElement(P.b,{path:Vt.fallback,render:function(){return i.a.createElement(aa,null)}})),i.a.createElement(pa,null))),a&&i.a.createElement("div",{className:n.confetti},i.a.createElement(Vn,null)),i.a.createElement(la,null))})),$n="true"===Object({NODE_ENV:"production",PUBLIC_URL:"/discussion-board-client",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).DEBUG?Object(s.d)(j,m,Object(s.a)(u.a,y)):Object(s.d)(j,m,Object(s.a)(u.a)),qn=function(){return i.a.createElement(l.a,{store:$n},i.a.createElement(k.a,{theme:I},i.a.createElement(w.a,null),i.a.createElement(Xn,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(qn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[178,1,2]]]);
//# sourceMappingURL=main.153b64f6.chunk.js.map